# # Retrieve ECMWF ERA Interim temperature data for calculating heat waves
# 

import numpy as np
import pandas as pd

from ecmwfapi import ECMWFDataServer
from config import DATA_SRC


output_file = DATA_SRC / 'weather' / 'ecmwf' / 'era_interim_temperature_2m.nc'


server = ECMWFDataServer()
server.retrieve({
    "class": "ei",
    "dataset": "interim",
    "date": "1981-01-01/1981-01-02/1981-01-03/1981-01-04/1981-01-05/1981-01-06/1981-01-07/1981-01-08/1981-01-09/1981-01-10/1981-01-11/1981-01-12/1981-01-13/1981-01-14/1981-01-15/1981-01-16/1981-01-17/1981-01-18/1981-01-19/1981-01-20/1981-01-21/1981-01-22/1981-01-23/1981-01-24/1981-01-25/1981-01-26/1981-01-27/1981-01-28/1981-01-29/1981-01-30/1981-01-31/1981-02-01/1981-02-02/1981-02-03/1981-02-04/1981-02-05/1981-02-06/1981-02-07/1981-02-08/1981-02-09/1981-02-10/1981-02-11/1981-02-12/1981-02-13/1981-02-14/1981-02-15/1981-02-16/1981-02-17/1981-02-18/1981-02-19/1981-02-20/1981-02-21/1981-02-22/1981-02-23/1981-02-24/1981-02-25/1981-02-26/1981-02-27/1981-02-28/1981-06-01/1981-06-02/1981-06-03/1981-06-04/1981-06-05/1981-06-06/1981-06-07/1981-06-08/1981-06-09/1981-06-10/1981-06-11/1981-06-12/1981-06-13/1981-06-14/1981-06-15/1981-06-16/1981-06-17/1981-06-18/1981-06-19/1981-06-20/1981-06-21/1981-06-22/1981-06-23/1981-06-24/1981-06-25/1981-06-26/1981-06-27/1981-06-28/1981-06-29/1981-06-30/1981-07-01/1981-07-02/1981-07-03/1981-07-04/1981-07-05/1981-07-06/1981-07-07/1981-07-08/1981-07-09/1981-07-10/1981-07-11/1981-07-12/1981-07-13/1981-07-14/1981-07-15/1981-07-16/1981-07-17/1981-07-18/1981-07-19/1981-07-20/1981-07-21/1981-07-22/1981-07-23/1981-07-24/1981-07-25/1981-07-26/1981-07-27/1981-07-28/1981-07-29/1981-07-30/1981-07-31/1981-08-01/1981-08-02/1981-08-03/1981-08-04/1981-08-05/1981-08-06/1981-08-07/1981-08-08/1981-08-09/1981-08-10/1981-08-11/1981-08-12/1981-08-13/1981-08-14/1981-08-15/1981-08-16/1981-08-17/1981-08-18/1981-08-19/1981-08-20/1981-08-21/1981-08-22/1981-08-23/1981-08-24/1981-08-25/1981-08-26/1981-08-27/1981-08-28/1981-08-29/1981-08-30/1981-08-31/1981-12-01/1981-12-02/1981-12-03/1981-12-04/1981-12-05/1981-12-06/1981-12-07/1981-12-08/1981-12-09/1981-12-10/1981-12-11/1981-12-12/1981-12-13/1981-12-14/1981-12-15/1981-12-16/1981-12-17/1981-12-18/1981-12-19/1981-12-20/1981-12-21/1981-12-22/1981-12-23/1981-12-24/1981-12-25/1981-12-26/1981-12-27/1981-12-28/1981-12-29/1981-12-30/1981-12-31/1982-01-01/1982-01-02/1982-01-03/1982-01-04/1982-01-05/1982-01-06/1982-01-07/1982-01-08/1982-01-09/1982-01-10/1982-01-11/1982-01-12/1982-01-13/1982-01-14/1982-01-15/1982-01-16/1982-01-17/1982-01-18/1982-01-19/1982-01-20/1982-01-21/1982-01-22/1982-01-23/1982-01-24/1982-01-25/1982-01-26/1982-01-27/1982-01-28/1982-01-29/1982-01-30/1982-01-31/1982-02-01/1982-02-02/1982-02-03/1982-02-04/1982-02-05/1982-02-06/1982-02-07/1982-02-08/1982-02-09/1982-02-10/1982-02-11/1982-02-12/1982-02-13/1982-02-14/1982-02-15/1982-02-16/1982-02-17/1982-02-18/1982-02-19/1982-02-20/1982-02-21/1982-02-22/1982-02-23/1982-02-24/1982-02-25/1982-02-26/1982-02-27/1982-02-28/1982-06-01/1982-06-02/1982-06-03/1982-06-04/1982-06-05/1982-06-06/1982-06-07/1982-06-08/1982-06-09/1982-06-10/1982-06-11/1982-06-12/1982-06-13/1982-06-14/1982-06-15/1982-06-16/1982-06-17/1982-06-18/1982-06-19/1982-06-20/1982-06-21/1982-06-22/1982-06-23/1982-06-24/1982-06-25/1982-06-26/1982-06-27/1982-06-28/1982-06-29/1982-06-30/1982-07-01/1982-07-02/1982-07-03/1982-07-04/1982-07-05/1982-07-06/1982-07-07/1982-07-08/1982-07-09/1982-07-10/1982-07-11/1982-07-12/1982-07-13/1982-07-14/1982-07-15/1982-07-16/1982-07-17/1982-07-18/1982-07-19/1982-07-20/1982-07-21/1982-07-22/1982-07-23/1982-07-24/1982-07-25/1982-07-26/1982-07-27/1982-07-28/1982-07-29/1982-07-30/1982-07-31/1982-08-01/1982-08-02/1982-08-03/1982-08-04/1982-08-05/1982-08-06/1982-08-07/1982-08-08/1982-08-09/1982-08-10/1982-08-11/1982-08-12/1982-08-13/1982-08-14/1982-08-15/1982-08-16/1982-08-17/1982-08-18/1982-08-19/1982-08-20/1982-08-21/1982-08-22/1982-08-23/1982-08-24/1982-08-25/1982-08-26/1982-08-27/1982-08-28/1982-08-29/1982-08-30/1982-08-31/1982-12-01/1982-12-02/1982-12-03/1982-12-04/1982-12-05/1982-12-06/1982-12-07/1982-12-08/1982-12-09/1982-12-10/1982-12-11/1982-12-12/1982-12-13/1982-12-14/1982-12-15/1982-12-16/1982-12-17/1982-12-18/1982-12-19/1982-12-20/1982-12-21/1982-12-22/1982-12-23/1982-12-24/1982-12-25/1982-12-26/1982-12-27/1982-12-28/1982-12-29/1982-12-30/1982-12-31/1983-01-01/1983-01-02/1983-01-03/1983-01-04/1983-01-05/1983-01-06/1983-01-07/1983-01-08/1983-01-09/1983-01-10/1983-01-11/1983-01-12/1983-01-13/1983-01-14/1983-01-15/1983-01-16/1983-01-17/1983-01-18/1983-01-19/1983-01-20/1983-01-21/1983-01-22/1983-01-23/1983-01-24/1983-01-25/1983-01-26/1983-01-27/1983-01-28/1983-01-29/1983-01-30/1983-01-31/1983-02-01/1983-02-02/1983-02-03/1983-02-04/1983-02-05/1983-02-06/1983-02-07/1983-02-08/1983-02-09/1983-02-10/1983-02-11/1983-02-12/1983-02-13/1983-02-14/1983-02-15/1983-02-16/1983-02-17/1983-02-18/1983-02-19/1983-02-20/1983-02-21/1983-02-22/1983-02-23/1983-02-24/1983-02-25/1983-02-26/1983-02-27/1983-02-28/1983-06-01/1983-06-02/1983-06-03/1983-06-04/1983-06-05/1983-06-06/1983-06-07/1983-06-08/1983-06-09/1983-06-10/1983-06-11/1983-06-12/1983-06-13/1983-06-14/1983-06-15/1983-06-16/1983-06-17/1983-06-18/1983-06-19/1983-06-20/1983-06-21/1983-06-22/1983-06-23/1983-06-24/1983-06-25/1983-06-26/1983-06-27/1983-06-28/1983-06-29/1983-06-30/1983-07-01/1983-07-02/1983-07-03/1983-07-04/1983-07-05/1983-07-06/1983-07-07/1983-07-08/1983-07-09/1983-07-10/1983-07-11/1983-07-12/1983-07-13/1983-07-14/1983-07-15/1983-07-16/1983-07-17/1983-07-18/1983-07-19/1983-07-20/1983-07-21/1983-07-22/1983-07-23/1983-07-24/1983-07-25/1983-07-26/1983-07-27/1983-07-28/1983-07-29/1983-07-30/1983-07-31/1983-08-01/1983-08-02/1983-08-03/1983-08-04/1983-08-05/1983-08-06/1983-08-07/1983-08-08/1983-08-09/1983-08-10/1983-08-11/1983-08-12/1983-08-13/1983-08-14/1983-08-15/1983-08-16/1983-08-17/1983-08-18/1983-08-19/1983-08-20/1983-08-21/1983-08-22/1983-08-23/1983-08-24/1983-08-25/1983-08-26/1983-08-27/1983-08-28/1983-08-29/1983-08-30/1983-08-31/1983-12-01/1983-12-02/1983-12-03/1983-12-04/1983-12-05/1983-12-06/1983-12-07/1983-12-08/1983-12-09/1983-12-10/1983-12-11/1983-12-12/1983-12-13/1983-12-14/1983-12-15/1983-12-16/1983-12-17/1983-12-18/1983-12-19/1983-12-20/1983-12-21/1983-12-22/1983-12-23/1983-12-24/1983-12-25/1983-12-26/1983-12-27/1983-12-28/1983-12-29/1983-12-30/1983-12-31/1984-01-01/1984-01-02/1984-01-03/1984-01-04/1984-01-05/1984-01-06/1984-01-07/1984-01-08/1984-01-09/1984-01-10/1984-01-11/1984-01-12/1984-01-13/1984-01-14/1984-01-15/1984-01-16/1984-01-17/1984-01-18/1984-01-19/1984-01-20/1984-01-21/1984-01-22/1984-01-23/1984-01-24/1984-01-25/1984-01-26/1984-01-27/1984-01-28/1984-01-29/1984-01-30/1984-01-31/1984-02-01/1984-02-02/1984-02-03/1984-02-04/1984-02-05/1984-02-06/1984-02-07/1984-02-08/1984-02-09/1984-02-10/1984-02-11/1984-02-12/1984-02-13/1984-02-14/1984-02-15/1984-02-16/1984-02-17/1984-02-18/1984-02-19/1984-02-20/1984-02-21/1984-02-22/1984-02-23/1984-02-24/1984-02-25/1984-02-26/1984-02-27/1984-02-28/1984-02-29/1984-06-01/1984-06-02/1984-06-03/1984-06-04/1984-06-05/1984-06-06/1984-06-07/1984-06-08/1984-06-09/1984-06-10/1984-06-11/1984-06-12/1984-06-13/1984-06-14/1984-06-15/1984-06-16/1984-06-17/1984-06-18/1984-06-19/1984-06-20/1984-06-21/1984-06-22/1984-06-23/1984-06-24/1984-06-25/1984-06-26/1984-06-27/1984-06-28/1984-06-29/1984-06-30/1984-07-01/1984-07-02/1984-07-03/1984-07-04/1984-07-05/1984-07-06/1984-07-07/1984-07-08/1984-07-09/1984-07-10/1984-07-11/1984-07-12/1984-07-13/1984-07-14/1984-07-15/1984-07-16/1984-07-17/1984-07-18/1984-07-19/1984-07-20/1984-07-21/1984-07-22/1984-07-23/1984-07-24/1984-07-25/1984-07-26/1984-07-27/1984-07-28/1984-07-29/1984-07-30/1984-07-31/1984-08-01/1984-08-02/1984-08-03/1984-08-04/1984-08-05/1984-08-06/1984-08-07/1984-08-08/1984-08-09/1984-08-10/1984-08-11/1984-08-12/1984-08-13/1984-08-14/1984-08-15/1984-08-16/1984-08-17/1984-08-18/1984-08-19/1984-08-20/1984-08-21/1984-08-22/1984-08-23/1984-08-24/1984-08-25/1984-08-26/1984-08-27/1984-08-28/1984-08-29/1984-08-30/1984-08-31/1984-12-01/1984-12-02/1984-12-03/1984-12-04/1984-12-05/1984-12-06/1984-12-07/1984-12-08/1984-12-09/1984-12-10/1984-12-11/1984-12-12/1984-12-13/1984-12-14/1984-12-15/1984-12-16/1984-12-17/1984-12-18/1984-12-19/1984-12-20/1984-12-21/1984-12-22/1984-12-23/1984-12-24/1984-12-25/1984-12-26/1984-12-27/1984-12-28/1984-12-29/1984-12-30/1984-12-31/1985-01-01/1985-01-02/1985-01-03/1985-01-04/1985-01-05/1985-01-06/1985-01-07/1985-01-08/1985-01-09/1985-01-10/1985-01-11/1985-01-12/1985-01-13/1985-01-14/1985-01-15/1985-01-16/1985-01-17/1985-01-18/1985-01-19/1985-01-20/1985-01-21/1985-01-22/1985-01-23/1985-01-24/1985-01-25/1985-01-26/1985-01-27/1985-01-28/1985-01-29/1985-01-30/1985-01-31/1985-02-01/1985-02-02/1985-02-03/1985-02-04/1985-02-05/1985-02-06/1985-02-07/1985-02-08/1985-02-09/1985-02-10/1985-02-11/1985-02-12/1985-02-13/1985-02-14/1985-02-15/1985-02-16/1985-02-17/1985-02-18/1985-02-19/1985-02-20/1985-02-21/1985-02-22/1985-02-23/1985-02-24/1985-02-25/1985-02-26/1985-02-27/1985-02-28/1985-06-01/1985-06-02/1985-06-03/1985-06-04/1985-06-05/1985-06-06/1985-06-07/1985-06-08/1985-06-09/1985-06-10/1985-06-11/1985-06-12/1985-06-13/1985-06-14/1985-06-15/1985-06-16/1985-06-17/1985-06-18/1985-06-19/1985-06-20/1985-06-21/1985-06-22/1985-06-23/1985-06-24/1985-06-25/1985-06-26/1985-06-27/1985-06-28/1985-06-29/1985-06-30/1985-07-01/1985-07-02/1985-07-03/1985-07-04/1985-07-05/1985-07-06/1985-07-07/1985-07-08/1985-07-09/1985-07-10/1985-07-11/1985-07-12/1985-07-13/1985-07-14/1985-07-15/1985-07-16/1985-07-17/1985-07-18/1985-07-19/1985-07-20/1985-07-21/1985-07-22/1985-07-23/1985-07-24/1985-07-25/1985-07-26/1985-07-27/1985-07-28/1985-07-29/1985-07-30/1985-07-31/1985-08-01/1985-08-02/1985-08-03/1985-08-04/1985-08-05/1985-08-06/1985-08-07/1985-08-08/1985-08-09/1985-08-10/1985-08-11/1985-08-12/1985-08-13/1985-08-14/1985-08-15/1985-08-16/1985-08-17/1985-08-18/1985-08-19/1985-08-20/1985-08-21/1985-08-22/1985-08-23/1985-08-24/1985-08-25/1985-08-26/1985-08-27/1985-08-28/1985-08-29/1985-08-30/1985-08-31/1985-12-01/1985-12-02/1985-12-03/1985-12-04/1985-12-05/1985-12-06/1985-12-07/1985-12-08/1985-12-09/1985-12-10/1985-12-11/1985-12-12/1985-12-13/1985-12-14/1985-12-15/1985-12-16/1985-12-17/1985-12-18/1985-12-19/1985-12-20/1985-12-21/1985-12-22/1985-12-23/1985-12-24/1985-12-25/1985-12-26/1985-12-27/1985-12-28/1985-12-29/1985-12-30/1985-12-31/1986-01-01/1986-01-02/1986-01-03/1986-01-04/1986-01-05/1986-01-06/1986-01-07/1986-01-08/1986-01-09/1986-01-10/1986-01-11/1986-01-12/1986-01-13/1986-01-14/1986-01-15/1986-01-16/1986-01-17/1986-01-18/1986-01-19/1986-01-20/1986-01-21/1986-01-22/1986-01-23/1986-01-24/1986-01-25/1986-01-26/1986-01-27/1986-01-28/1986-01-29/1986-01-30/1986-01-31/1986-02-01/1986-02-02/1986-02-03/1986-02-04/1986-02-05/1986-02-06/1986-02-07/1986-02-08/1986-02-09/1986-02-10/1986-02-11/1986-02-12/1986-02-13/1986-02-14/1986-02-15/1986-02-16/1986-02-17/1986-02-18/1986-02-19/1986-02-20/1986-02-21/1986-02-22/1986-02-23/1986-02-24/1986-02-25/1986-02-26/1986-02-27/1986-02-28/1986-06-01/1986-06-02/1986-06-03/1986-06-04/1986-06-05/1986-06-06/1986-06-07/1986-06-08/1986-06-09/1986-06-10/1986-06-11/1986-06-12/1986-06-13/1986-06-14/1986-06-15/1986-06-16/1986-06-17/1986-06-18/1986-06-19/1986-06-20/1986-06-21/1986-06-22/1986-06-23/1986-06-24/1986-06-25/1986-06-26/1986-06-27/1986-06-28/1986-06-29/1986-06-30/1986-07-01/1986-07-02/1986-07-03/1986-07-04/1986-07-05/1986-07-06/1986-07-07/1986-07-08/1986-07-09/1986-07-10/1986-07-11/1986-07-12/1986-07-13/1986-07-14/1986-07-15/1986-07-16/1986-07-17/1986-07-18/1986-07-19/1986-07-20/1986-07-21/1986-07-22/1986-07-23/1986-07-24/1986-07-25/1986-07-26/1986-07-27/1986-07-28/1986-07-29/1986-07-30/1986-07-31/1986-08-01/1986-08-02/1986-08-03/1986-08-04/1986-08-05/1986-08-06/1986-08-07/1986-08-08/1986-08-09/1986-08-10/1986-08-11/1986-08-12/1986-08-13/1986-08-14/1986-08-15/1986-08-16/1986-08-17/1986-08-18/1986-08-19/1986-08-20/1986-08-21/1986-08-22/1986-08-23/1986-08-24/1986-08-25/1986-08-26/1986-08-27/1986-08-28/1986-08-29/1986-08-30/1986-08-31/1986-12-01/1986-12-02/1986-12-03/1986-12-04/1986-12-05/1986-12-06/1986-12-07/1986-12-08/1986-12-09/1986-12-10/1986-12-11/1986-12-12/1986-12-13/1986-12-14/1986-12-15/1986-12-16/1986-12-17/1986-12-18/1986-12-19/1986-12-20/1986-12-21/1986-12-22/1986-12-23/1986-12-24/1986-12-25/1986-12-26/1986-12-27/1986-12-28/1986-12-29/1986-12-30/1986-12-31/1987-01-01/1987-01-02/1987-01-03/1987-01-04/1987-01-05/1987-01-06/1987-01-07/1987-01-08/1987-01-09/1987-01-10/1987-01-11/1987-01-12/1987-01-13/1987-01-14/1987-01-15/1987-01-16/1987-01-17/1987-01-18/1987-01-19/1987-01-20/1987-01-21/1987-01-22/1987-01-23/1987-01-24/1987-01-25/1987-01-26/1987-01-27/1987-01-28/1987-01-29/1987-01-30/1987-01-31/1987-02-01/1987-02-02/1987-02-03/1987-02-04/1987-02-05/1987-02-06/1987-02-07/1987-02-08/1987-02-09/1987-02-10/1987-02-11/1987-02-12/1987-02-13/1987-02-14/1987-02-15/1987-02-16/1987-02-17/1987-02-18/1987-02-19/1987-02-20/1987-02-21/1987-02-22/1987-02-23/1987-02-24/1987-02-25/1987-02-26/1987-02-27/1987-02-28/1987-06-01/1987-06-02/1987-06-03/1987-06-04/1987-06-05/1987-06-06/1987-06-07/1987-06-08/1987-06-09/1987-06-10/1987-06-11/1987-06-12/1987-06-13/1987-06-14/1987-06-15/1987-06-16/1987-06-17/1987-06-18/1987-06-19/1987-06-20/1987-06-21/1987-06-22/1987-06-23/1987-06-24/1987-06-25/1987-06-26/1987-06-27/1987-06-28/1987-06-29/1987-06-30/1987-07-01/1987-07-02/1987-07-03/1987-07-04/1987-07-05/1987-07-06/1987-07-07/1987-07-08/1987-07-09/1987-07-10/1987-07-11/1987-07-12/1987-07-13/1987-07-14/1987-07-15/1987-07-16/1987-07-17/1987-07-18/1987-07-19/1987-07-20/1987-07-21/1987-07-22/1987-07-23/1987-07-24/1987-07-25/1987-07-26/1987-07-27/1987-07-28/1987-07-29/1987-07-30/1987-07-31/1987-08-01/1987-08-02/1987-08-03/1987-08-04/1987-08-05/1987-08-06/1987-08-07/1987-08-08/1987-08-09/1987-08-10/1987-08-11/1987-08-12/1987-08-13/1987-08-14/1987-08-15/1987-08-16/1987-08-17/1987-08-18/1987-08-19/1987-08-20/1987-08-21/1987-08-22/1987-08-23/1987-08-24/1987-08-25/1987-08-26/1987-08-27/1987-08-28/1987-08-29/1987-08-30/1987-08-31/1987-12-01/1987-12-02/1987-12-03/1987-12-04/1987-12-05/1987-12-06/1987-12-07/1987-12-08/1987-12-09/1987-12-10/1987-12-11/1987-12-12/1987-12-13/1987-12-14/1987-12-15/1987-12-16/1987-12-17/1987-12-18/1987-12-19/1987-12-20/1987-12-21/1987-12-22/1987-12-23/1987-12-24/1987-12-25/1987-12-26/1987-12-27/1987-12-28/1987-12-29/1987-12-30/1987-12-31/1988-01-01/1988-01-02/1988-01-03/1988-01-04/1988-01-05/1988-01-06/1988-01-07/1988-01-08/1988-01-09/1988-01-10/1988-01-11/1988-01-12/1988-01-13/1988-01-14/1988-01-15/1988-01-16/1988-01-17/1988-01-18/1988-01-19/1988-01-20/1988-01-21/1988-01-22/1988-01-23/1988-01-24/1988-01-25/1988-01-26/1988-01-27/1988-01-28/1988-01-29/1988-01-30/1988-01-31/1988-02-01/1988-02-02/1988-02-03/1988-02-04/1988-02-05/1988-02-06/1988-02-07/1988-02-08/1988-02-09/1988-02-10/1988-02-11/1988-02-12/1988-02-13/1988-02-14/1988-02-15/1988-02-16/1988-02-17/1988-02-18/1988-02-19/1988-02-20/1988-02-21/1988-02-22/1988-02-23/1988-02-24/1988-02-25/1988-02-26/1988-02-27/1988-02-28/1988-02-29/1988-06-01/1988-06-02/1988-06-03/1988-06-04/1988-06-05/1988-06-06/1988-06-07/1988-06-08/1988-06-09/1988-06-10/1988-06-11/1988-06-12/1988-06-13/1988-06-14/1988-06-15/1988-06-16/1988-06-17/1988-06-18/1988-06-19/1988-06-20/1988-06-21/1988-06-22/1988-06-23/1988-06-24/1988-06-25/1988-06-26/1988-06-27/1988-06-28/1988-06-29/1988-06-30/1988-07-01/1988-07-02/1988-07-03/1988-07-04/1988-07-05/1988-07-06/1988-07-07/1988-07-08/1988-07-09/1988-07-10/1988-07-11/1988-07-12/1988-07-13/1988-07-14/1988-07-15/1988-07-16/1988-07-17/1988-07-18/1988-07-19/1988-07-20/1988-07-21/1988-07-22/1988-07-23/1988-07-24/1988-07-25/1988-07-26/1988-07-27/1988-07-28/1988-07-29/1988-07-30/1988-07-31/1988-08-01/1988-08-02/1988-08-03/1988-08-04/1988-08-05/1988-08-06/1988-08-07/1988-08-08/1988-08-09/1988-08-10/1988-08-11/1988-08-12/1988-08-13/1988-08-14/1988-08-15/1988-08-16/1988-08-17/1988-08-18/1988-08-19/1988-08-20/1988-08-21/1988-08-22/1988-08-23/1988-08-24/1988-08-25/1988-08-26/1988-08-27/1988-08-28/1988-08-29/1988-08-30/1988-08-31/1988-12-01/1988-12-02/1988-12-03/1988-12-04/1988-12-05/1988-12-06/1988-12-07/1988-12-08/1988-12-09/1988-12-10/1988-12-11/1988-12-12/1988-12-13/1988-12-14/1988-12-15/1988-12-16/1988-12-17/1988-12-18/1988-12-19/1988-12-20/1988-12-21/1988-12-22/1988-12-23/1988-12-24/1988-12-25/1988-12-26/1988-12-27/1988-12-28/1988-12-29/1988-12-30/1988-12-31/1989-01-01/1989-01-02/1989-01-03/1989-01-04/1989-01-05/1989-01-06/1989-01-07/1989-01-08/1989-01-09/1989-01-10/1989-01-11/1989-01-12/1989-01-13/1989-01-14/1989-01-15/1989-01-16/1989-01-17/1989-01-18/1989-01-19/1989-01-20/1989-01-21/1989-01-22/1989-01-23/1989-01-24/1989-01-25/1989-01-26/1989-01-27/1989-01-28/1989-01-29/1989-01-30/1989-01-31/1989-02-01/1989-02-02/1989-02-03/1989-02-04/1989-02-05/1989-02-06/1989-02-07/1989-02-08/1989-02-09/1989-02-10/1989-02-11/1989-02-12/1989-02-13/1989-02-14/1989-02-15/1989-02-16/1989-02-17/1989-02-18/1989-02-19/1989-02-20/1989-02-21/1989-02-22/1989-02-23/1989-02-24/1989-02-25/1989-02-26/1989-02-27/1989-02-28/1989-06-01/1989-06-02/1989-06-03/1989-06-04/1989-06-05/1989-06-06/1989-06-07/1989-06-08/1989-06-09/1989-06-10/1989-06-11/1989-06-12/1989-06-13/1989-06-14/1989-06-15/1989-06-16/1989-06-17/1989-06-18/1989-06-19/1989-06-20/1989-06-21/1989-06-22/1989-06-23/1989-06-24/1989-06-25/1989-06-26/1989-06-27/1989-06-28/1989-06-29/1989-06-30/1989-07-01/1989-07-02/1989-07-03/1989-07-04/1989-07-05/1989-07-06/1989-07-07/1989-07-08/1989-07-09/1989-07-10/1989-07-11/1989-07-12/1989-07-13/1989-07-14/1989-07-15/1989-07-16/1989-07-17/1989-07-18/1989-07-19/1989-07-20/1989-07-21/1989-07-22/1989-07-23/1989-07-24/1989-07-25/1989-07-26/1989-07-27/1989-07-28/1989-07-29/1989-07-30/1989-07-31/1989-08-01/1989-08-02/1989-08-03/1989-08-04/1989-08-05/1989-08-06/1989-08-07/1989-08-08/1989-08-09/1989-08-10/1989-08-11/1989-08-12/1989-08-13/1989-08-14/1989-08-15/1989-08-16/1989-08-17/1989-08-18/1989-08-19/1989-08-20/1989-08-21/1989-08-22/1989-08-23/1989-08-24/1989-08-25/1989-08-26/1989-08-27/1989-08-28/1989-08-29/1989-08-30/1989-08-31/1989-12-01/1989-12-02/1989-12-03/1989-12-04/1989-12-05/1989-12-06/1989-12-07/1989-12-08/1989-12-09/1989-12-10/1989-12-11/1989-12-12/1989-12-13/1989-12-14/1989-12-15/1989-12-16/1989-12-17/1989-12-18/1989-12-19/1989-12-20/1989-12-21/1989-12-22/1989-12-23/1989-12-24/1989-12-25/1989-12-26/1989-12-27/1989-12-28/1989-12-29/1989-12-30/1989-12-31/1990-01-01/1990-01-02/1990-01-03/1990-01-04/1990-01-05/1990-01-06/1990-01-07/1990-01-08/1990-01-09/1990-01-10/1990-01-11/1990-01-12/1990-01-13/1990-01-14/1990-01-15/1990-01-16/1990-01-17/1990-01-18/1990-01-19/1990-01-20/1990-01-21/1990-01-22/1990-01-23/1990-01-24/1990-01-25/1990-01-26/1990-01-27/1990-01-28/1990-01-29/1990-01-30/1990-01-31/1990-02-01/1990-02-02/1990-02-03/1990-02-04/1990-02-05/1990-02-06/1990-02-07/1990-02-08/1990-02-09/1990-02-10/1990-02-11/1990-02-12/1990-02-13/1990-02-14/1990-02-15/1990-02-16/1990-02-17/1990-02-18/1990-02-19/1990-02-20/1990-02-21/1990-02-22/1990-02-23/1990-02-24/1990-02-25/1990-02-26/1990-02-27/1990-02-28/1990-06-01/1990-06-02/1990-06-03/1990-06-04/1990-06-05/1990-06-06/1990-06-07/1990-06-08/1990-06-09/1990-06-10/1990-06-11/1990-06-12/1990-06-13/1990-06-14/1990-06-15/1990-06-16/1990-06-17/1990-06-18/1990-06-19/1990-06-20/1990-06-21/1990-06-22/1990-06-23/1990-06-24/1990-06-25/1990-06-26/1990-06-27/1990-06-28/1990-06-29/1990-06-30/1990-07-01/1990-07-02/1990-07-03/1990-07-04/1990-07-05/1990-07-06/1990-07-07/1990-07-08/1990-07-09/1990-07-10/1990-07-11/1990-07-12/1990-07-13/1990-07-14/1990-07-15/1990-07-16/1990-07-17/1990-07-18/1990-07-19/1990-07-20/1990-07-21/1990-07-22/1990-07-23/1990-07-24/1990-07-25/1990-07-26/1990-07-27/1990-07-28/1990-07-29/1990-07-30/1990-07-31/1990-08-01/1990-08-02/1990-08-03/1990-08-04/1990-08-05/1990-08-06/1990-08-07/1990-08-08/1990-08-09/1990-08-10/1990-08-11/1990-08-12/1990-08-13/1990-08-14/1990-08-15/1990-08-16/1990-08-17/1990-08-18/1990-08-19/1990-08-20/1990-08-21/1990-08-22/1990-08-23/1990-08-24/1990-08-25/1990-08-26/1990-08-27/1990-08-28/1990-08-29/1990-08-30/1990-08-31/1990-12-01/1990-12-02/1990-12-03/1990-12-04/1990-12-05/1990-12-06/1990-12-07/1990-12-08/1990-12-09/1990-12-10/1990-12-11/1990-12-12/1990-12-13/1990-12-14/1990-12-15/1990-12-16/1990-12-17/1990-12-18/1990-12-19/1990-12-20/1990-12-21/1990-12-22/1990-12-23/1990-12-24/1990-12-25/1990-12-26/1990-12-27/1990-12-28/1990-12-29/1990-12-30/1990-12-31/1991-01-01/1991-01-02/1991-01-03/1991-01-04/1991-01-05/1991-01-06/1991-01-07/1991-01-08/1991-01-09/1991-01-10/1991-01-11/1991-01-12/1991-01-13/1991-01-14/1991-01-15/1991-01-16/1991-01-17/1991-01-18/1991-01-19/1991-01-20/1991-01-21/1991-01-22/1991-01-23/1991-01-24/1991-01-25/1991-01-26/1991-01-27/1991-01-28/1991-01-29/1991-01-30/1991-01-31/1991-02-01/1991-02-02/1991-02-03/1991-02-04/1991-02-05/1991-02-06/1991-02-07/1991-02-08/1991-02-09/1991-02-10/1991-02-11/1991-02-12/1991-02-13/1991-02-14/1991-02-15/1991-02-16/1991-02-17/1991-02-18/1991-02-19/1991-02-20/1991-02-21/1991-02-22/1991-02-23/1991-02-24/1991-02-25/1991-02-26/1991-02-27/1991-02-28/1991-06-01/1991-06-02/1991-06-03/1991-06-04/1991-06-05/1991-06-06/1991-06-07/1991-06-08/1991-06-09/1991-06-10/1991-06-11/1991-06-12/1991-06-13/1991-06-14/1991-06-15/1991-06-16/1991-06-17/1991-06-18/1991-06-19/1991-06-20/1991-06-21/1991-06-22/1991-06-23/1991-06-24/1991-06-25/1991-06-26/1991-06-27/1991-06-28/1991-06-29/1991-06-30/1991-07-01/1991-07-02/1991-07-03/1991-07-04/1991-07-05/1991-07-06/1991-07-07/1991-07-08/1991-07-09/1991-07-10/1991-07-11/1991-07-12/1991-07-13/1991-07-14/1991-07-15/1991-07-16/1991-07-17/1991-07-18/1991-07-19/1991-07-20/1991-07-21/1991-07-22/1991-07-23/1991-07-24/1991-07-25/1991-07-26/1991-07-27/1991-07-28/1991-07-29/1991-07-30/1991-07-31/1991-08-01/1991-08-02/1991-08-03/1991-08-04/1991-08-05/1991-08-06/1991-08-07/1991-08-08/1991-08-09/1991-08-10/1991-08-11/1991-08-12/1991-08-13/1991-08-14/1991-08-15/1991-08-16/1991-08-17/1991-08-18/1991-08-19/1991-08-20/1991-08-21/1991-08-22/1991-08-23/1991-08-24/1991-08-25/1991-08-26/1991-08-27/1991-08-28/1991-08-29/1991-08-30/1991-08-31/1991-12-01/1991-12-02/1991-12-03/1991-12-04/1991-12-05/1991-12-06/1991-12-07/1991-12-08/1991-12-09/1991-12-10/1991-12-11/1991-12-12/1991-12-13/1991-12-14/1991-12-15/1991-12-16/1991-12-17/1991-12-18/1991-12-19/1991-12-20/1991-12-21/1991-12-22/1991-12-23/1991-12-24/1991-12-25/1991-12-26/1991-12-27/1991-12-28/1991-12-29/1991-12-30/1991-12-31/1992-01-01/1992-01-02/1992-01-03/1992-01-04/1992-01-05/1992-01-06/1992-01-07/1992-01-08/1992-01-09/1992-01-10/1992-01-11/1992-01-12/1992-01-13/1992-01-14/1992-01-15/1992-01-16/1992-01-17/1992-01-18/1992-01-19/1992-01-20/1992-01-21/1992-01-22/1992-01-23/1992-01-24/1992-01-25/1992-01-26/1992-01-27/1992-01-28/1992-01-29/1992-01-30/1992-01-31/1992-02-01/1992-02-02/1992-02-03/1992-02-04/1992-02-05/1992-02-06/1992-02-07/1992-02-08/1992-02-09/1992-02-10/1992-02-11/1992-02-12/1992-02-13/1992-02-14/1992-02-15/1992-02-16/1992-02-17/1992-02-18/1992-02-19/1992-02-20/1992-02-21/1992-02-22/1992-02-23/1992-02-24/1992-02-25/1992-02-26/1992-02-27/1992-02-28/1992-02-29/1992-06-01/1992-06-02/1992-06-03/1992-06-04/1992-06-05/1992-06-06/1992-06-07/1992-06-08/1992-06-09/1992-06-10/1992-06-11/1992-06-12/1992-06-13/1992-06-14/1992-06-15/1992-06-16/1992-06-17/1992-06-18/1992-06-19/1992-06-20/1992-06-21/1992-06-22/1992-06-23/1992-06-24/1992-06-25/1992-06-26/1992-06-27/1992-06-28/1992-06-29/1992-06-30/1992-07-01/1992-07-02/1992-07-03/1992-07-04/1992-07-05/1992-07-06/1992-07-07/1992-07-08/1992-07-09/1992-07-10/1992-07-11/1992-07-12/1992-07-13/1992-07-14/1992-07-15/1992-07-16/1992-07-17/1992-07-18/1992-07-19/1992-07-20/1992-07-21/1992-07-22/1992-07-23/1992-07-24/1992-07-25/1992-07-26/1992-07-27/1992-07-28/1992-07-29/1992-07-30/1992-07-31/1992-08-01/1992-08-02/1992-08-03/1992-08-04/1992-08-05/1992-08-06/1992-08-07/1992-08-08/1992-08-09/1992-08-10/1992-08-11/1992-08-12/1992-08-13/1992-08-14/1992-08-15/1992-08-16/1992-08-17/1992-08-18/1992-08-19/1992-08-20/1992-08-21/1992-08-22/1992-08-23/1992-08-24/1992-08-25/1992-08-26/1992-08-27/1992-08-28/1992-08-29/1992-08-30/1992-08-31/1992-12-01/1992-12-02/1992-12-03/1992-12-04/1992-12-05/1992-12-06/1992-12-07/1992-12-08/1992-12-09/1992-12-10/1992-12-11/1992-12-12/1992-12-13/1992-12-14/1992-12-15/1992-12-16/1992-12-17/1992-12-18/1992-12-19/1992-12-20/1992-12-21/1992-12-22/1992-12-23/1992-12-24/1992-12-25/1992-12-26/1992-12-27/1992-12-28/1992-12-29/1992-12-30/1992-12-31/1993-01-01/1993-01-02/1993-01-03/1993-01-04/1993-01-05/1993-01-06/1993-01-07/1993-01-08/1993-01-09/1993-01-10/1993-01-11/1993-01-12/1993-01-13/1993-01-14/1993-01-15/1993-01-16/1993-01-17/1993-01-18/1993-01-19/1993-01-20/1993-01-21/1993-01-22/1993-01-23/1993-01-24/1993-01-25/1993-01-26/1993-01-27/1993-01-28/1993-01-29/1993-01-30/1993-01-31/1993-02-01/1993-02-02/1993-02-03/1993-02-04/1993-02-05/1993-02-06/1993-02-07/1993-02-08/1993-02-09/1993-02-10/1993-02-11/1993-02-12/1993-02-13/1993-02-14/1993-02-15/1993-02-16/1993-02-17/1993-02-18/1993-02-19/1993-02-20/1993-02-21/1993-02-22/1993-02-23/1993-02-24/1993-02-25/1993-02-26/1993-02-27/1993-02-28/1993-06-01/1993-06-02/1993-06-03/1993-06-04/1993-06-05/1993-06-06/1993-06-07/1993-06-08/1993-06-09/1993-06-10/1993-06-11/1993-06-12/1993-06-13/1993-06-14/1993-06-15/1993-06-16/1993-06-17/1993-06-18/1993-06-19/1993-06-20/1993-06-21/1993-06-22/1993-06-23/1993-06-24/1993-06-25/1993-06-26/1993-06-27/1993-06-28/1993-06-29/1993-06-30/1993-07-01/1993-07-02/1993-07-03/1993-07-04/1993-07-05/1993-07-06/1993-07-07/1993-07-08/1993-07-09/1993-07-10/1993-07-11/1993-07-12/1993-07-13/1993-07-14/1993-07-15/1993-07-16/1993-07-17/1993-07-18/1993-07-19/1993-07-20/1993-07-21/1993-07-22/1993-07-23/1993-07-24/1993-07-25/1993-07-26/1993-07-27/1993-07-28/1993-07-29/1993-07-30/1993-07-31/1993-08-01/1993-08-02/1993-08-03/1993-08-04/1993-08-05/1993-08-06/1993-08-07/1993-08-08/1993-08-09/1993-08-10/1993-08-11/1993-08-12/1993-08-13/1993-08-14/1993-08-15/1993-08-16/1993-08-17/1993-08-18/1993-08-19/1993-08-20/1993-08-21/1993-08-22/1993-08-23/1993-08-24/1993-08-25/1993-08-26/1993-08-27/1993-08-28/1993-08-29/1993-08-30/1993-08-31/1993-12-01/1993-12-02/1993-12-03/1993-12-04/1993-12-05/1993-12-06/1993-12-07/1993-12-08/1993-12-09/1993-12-10/1993-12-11/1993-12-12/1993-12-13/1993-12-14/1993-12-15/1993-12-16/1993-12-17/1993-12-18/1993-12-19/1993-12-20/1993-12-21/1993-12-22/1993-12-23/1993-12-24/1993-12-25/1993-12-26/1993-12-27/1993-12-28/1993-12-29/1993-12-30/1993-12-31/1994-01-01/1994-01-02/1994-01-03/1994-01-04/1994-01-05/1994-01-06/1994-01-07/1994-01-08/1994-01-09/1994-01-10/1994-01-11/1994-01-12/1994-01-13/1994-01-14/1994-01-15/1994-01-16/1994-01-17/1994-01-18/1994-01-19/1994-01-20/1994-01-21/1994-01-22/1994-01-23/1994-01-24/1994-01-25/1994-01-26/1994-01-27/1994-01-28/1994-01-29/1994-01-30/1994-01-31/1994-02-01/1994-02-02/1994-02-03/1994-02-04/1994-02-05/1994-02-06/1994-02-07/1994-02-08/1994-02-09/1994-02-10/1994-02-11/1994-02-12/1994-02-13/1994-02-14/1994-02-15/1994-02-16/1994-02-17/1994-02-18/1994-02-19/1994-02-20/1994-02-21/1994-02-22/1994-02-23/1994-02-24/1994-02-25/1994-02-26/1994-02-27/1994-02-28/1994-06-01/1994-06-02/1994-06-03/1994-06-04/1994-06-05/1994-06-06/1994-06-07/1994-06-08/1994-06-09/1994-06-10/1994-06-11/1994-06-12/1994-06-13/1994-06-14/1994-06-15/1994-06-16/1994-06-17/1994-06-18/1994-06-19/1994-06-20/1994-06-21/1994-06-22/1994-06-23/1994-06-24/1994-06-25/1994-06-26/1994-06-27/1994-06-28/1994-06-29/1994-06-30/1994-07-01/1994-07-02/1994-07-03/1994-07-04/1994-07-05/1994-07-06/1994-07-07/1994-07-08/1994-07-09/1994-07-10/1994-07-11/1994-07-12/1994-07-13/1994-07-14/1994-07-15/1994-07-16/1994-07-17/1994-07-18/1994-07-19/1994-07-20/1994-07-21/1994-07-22/1994-07-23/1994-07-24/1994-07-25/1994-07-26/1994-07-27/1994-07-28/1994-07-29/1994-07-30/1994-07-31/1994-08-01/1994-08-02/1994-08-03/1994-08-04/1994-08-05/1994-08-06/1994-08-07/1994-08-08/1994-08-09/1994-08-10/1994-08-11/1994-08-12/1994-08-13/1994-08-14/1994-08-15/1994-08-16/1994-08-17/1994-08-18/1994-08-19/1994-08-20/1994-08-21/1994-08-22/1994-08-23/1994-08-24/1994-08-25/1994-08-26/1994-08-27/1994-08-28/1994-08-29/1994-08-30/1994-08-31/1994-12-01/1994-12-02/1994-12-03/1994-12-04/1994-12-05/1994-12-06/1994-12-07/1994-12-08/1994-12-09/1994-12-10/1994-12-11/1994-12-12/1994-12-13/1994-12-14/1994-12-15/1994-12-16/1994-12-17/1994-12-18/1994-12-19/1994-12-20/1994-12-21/1994-12-22/1994-12-23/1994-12-24/1994-12-25/1994-12-26/1994-12-27/1994-12-28/1994-12-29/1994-12-30/1994-12-31/1995-01-01/1995-01-02/1995-01-03/1995-01-04/1995-01-05/1995-01-06/1995-01-07/1995-01-08/1995-01-09/1995-01-10/1995-01-11/1995-01-12/1995-01-13/1995-01-14/1995-01-15/1995-01-16/1995-01-17/1995-01-18/1995-01-19/1995-01-20/1995-01-21/1995-01-22/1995-01-23/1995-01-24/1995-01-25/1995-01-26/1995-01-27/1995-01-28/1995-01-29/1995-01-30/1995-01-31/1995-02-01/1995-02-02/1995-02-03/1995-02-04/1995-02-05/1995-02-06/1995-02-07/1995-02-08/1995-02-09/1995-02-10/1995-02-11/1995-02-12/1995-02-13/1995-02-14/1995-02-15/1995-02-16/1995-02-17/1995-02-18/1995-02-19/1995-02-20/1995-02-21/1995-02-22/1995-02-23/1995-02-24/1995-02-25/1995-02-26/1995-02-27/1995-02-28/1995-06-01/1995-06-02/1995-06-03/1995-06-04/1995-06-05/1995-06-06/1995-06-07/1995-06-08/1995-06-09/1995-06-10/1995-06-11/1995-06-12/1995-06-13/1995-06-14/1995-06-15/1995-06-16/1995-06-17/1995-06-18/1995-06-19/1995-06-20/1995-06-21/1995-06-22/1995-06-23/1995-06-24/1995-06-25/1995-06-26/1995-06-27/1995-06-28/1995-06-29/1995-06-30/1995-07-01/1995-07-02/1995-07-03/1995-07-04/1995-07-05/1995-07-06/1995-07-07/1995-07-08/1995-07-09/1995-07-10/1995-07-11/1995-07-12/1995-07-13/1995-07-14/1995-07-15/1995-07-16/1995-07-17/1995-07-18/1995-07-19/1995-07-20/1995-07-21/1995-07-22/1995-07-23/1995-07-24/1995-07-25/1995-07-26/1995-07-27/1995-07-28/1995-07-29/1995-07-30/1995-07-31/1995-08-01/1995-08-02/1995-08-03/1995-08-04/1995-08-05/1995-08-06/1995-08-07/1995-08-08/1995-08-09/1995-08-10/1995-08-11/1995-08-12/1995-08-13/1995-08-14/1995-08-15/1995-08-16/1995-08-17/1995-08-18/1995-08-19/1995-08-20/1995-08-21/1995-08-22/1995-08-23/1995-08-24/1995-08-25/1995-08-26/1995-08-27/1995-08-28/1995-08-29/1995-08-30/1995-08-31/1995-12-01/1995-12-02/1995-12-03/1995-12-04/1995-12-05/1995-12-06/1995-12-07/1995-12-08/1995-12-09/1995-12-10/1995-12-11/1995-12-12/1995-12-13/1995-12-14/1995-12-15/1995-12-16/1995-12-17/1995-12-18/1995-12-19/1995-12-20/1995-12-21/1995-12-22/1995-12-23/1995-12-24/1995-12-25/1995-12-26/1995-12-27/1995-12-28/1995-12-29/1995-12-30/1995-12-31/1996-01-01/1996-01-02/1996-01-03/1996-01-04/1996-01-05/1996-01-06/1996-01-07/1996-01-08/1996-01-09/1996-01-10/1996-01-11/1996-01-12/1996-01-13/1996-01-14/1996-01-15/1996-01-16/1996-01-17/1996-01-18/1996-01-19/1996-01-20/1996-01-21/1996-01-22/1996-01-23/1996-01-24/1996-01-25/1996-01-26/1996-01-27/1996-01-28/1996-01-29/1996-01-30/1996-01-31/1996-02-01/1996-02-02/1996-02-03/1996-02-04/1996-02-05/1996-02-06/1996-02-07/1996-02-08/1996-02-09/1996-02-10/1996-02-11/1996-02-12/1996-02-13/1996-02-14/1996-02-15/1996-02-16/1996-02-17/1996-02-18/1996-02-19/1996-02-20/1996-02-21/1996-02-22/1996-02-23/1996-02-24/1996-02-25/1996-02-26/1996-02-27/1996-02-28/1996-02-29/1996-06-01/1996-06-02/1996-06-03/1996-06-04/1996-06-05/1996-06-06/1996-06-07/1996-06-08/1996-06-09/1996-06-10/1996-06-11/1996-06-12/1996-06-13/1996-06-14/1996-06-15/1996-06-16/1996-06-17/1996-06-18/1996-06-19/1996-06-20/1996-06-21/1996-06-22/1996-06-23/1996-06-24/1996-06-25/1996-06-26/1996-06-27/1996-06-28/1996-06-29/1996-06-30/1996-07-01/1996-07-02/1996-07-03/1996-07-04/1996-07-05/1996-07-06/1996-07-07/1996-07-08/1996-07-09/1996-07-10/1996-07-11/1996-07-12/1996-07-13/1996-07-14/1996-07-15/1996-07-16/1996-07-17/1996-07-18/1996-07-19/1996-07-20/1996-07-21/1996-07-22/1996-07-23/1996-07-24/1996-07-25/1996-07-26/1996-07-27/1996-07-28/1996-07-29/1996-07-30/1996-07-31/1996-08-01/1996-08-02/1996-08-03/1996-08-04/1996-08-05/1996-08-06/1996-08-07/1996-08-08/1996-08-09/1996-08-10/1996-08-11/1996-08-12/1996-08-13/1996-08-14/1996-08-15/1996-08-16/1996-08-17/1996-08-18/1996-08-19/1996-08-20/1996-08-21/1996-08-22/1996-08-23/1996-08-24/1996-08-25/1996-08-26/1996-08-27/1996-08-28/1996-08-29/1996-08-30/1996-08-31/1996-12-01/1996-12-02/1996-12-03/1996-12-04/1996-12-05/1996-12-06/1996-12-07/1996-12-08/1996-12-09/1996-12-10/1996-12-11/1996-12-12/1996-12-13/1996-12-14/1996-12-15/1996-12-16/1996-12-17/1996-12-18/1996-12-19/1996-12-20/1996-12-21/1996-12-22/1996-12-23/1996-12-24/1996-12-25/1996-12-26/1996-12-27/1996-12-28/1996-12-29/1996-12-30/1996-12-31/1997-01-01/1997-01-02/1997-01-03/1997-01-04/1997-01-05/1997-01-06/1997-01-07/1997-01-08/1997-01-09/1997-01-10/1997-01-11/1997-01-12/1997-01-13/1997-01-14/1997-01-15/1997-01-16/1997-01-17/1997-01-18/1997-01-19/1997-01-20/1997-01-21/1997-01-22/1997-01-23/1997-01-24/1997-01-25/1997-01-26/1997-01-27/1997-01-28/1997-01-29/1997-01-30/1997-01-31/1997-02-01/1997-02-02/1997-02-03/1997-02-04/1997-02-05/1997-02-06/1997-02-07/1997-02-08/1997-02-09/1997-02-10/1997-02-11/1997-02-12/1997-02-13/1997-02-14/1997-02-15/1997-02-16/1997-02-17/1997-02-18/1997-02-19/1997-02-20/1997-02-21/1997-02-22/1997-02-23/1997-02-24/1997-02-25/1997-02-26/1997-02-27/1997-02-28/1997-06-01/1997-06-02/1997-06-03/1997-06-04/1997-06-05/1997-06-06/1997-06-07/1997-06-08/1997-06-09/1997-06-10/1997-06-11/1997-06-12/1997-06-13/1997-06-14/1997-06-15/1997-06-16/1997-06-17/1997-06-18/1997-06-19/1997-06-20/1997-06-21/1997-06-22/1997-06-23/1997-06-24/1997-06-25/1997-06-26/1997-06-27/1997-06-28/1997-06-29/1997-06-30/1997-07-01/1997-07-02/1997-07-03/1997-07-04/1997-07-05/1997-07-06/1997-07-07/1997-07-08/1997-07-09/1997-07-10/1997-07-11/1997-07-12/1997-07-13/1997-07-14/1997-07-15/1997-07-16/1997-07-17/1997-07-18/1997-07-19/1997-07-20/1997-07-21/1997-07-22/1997-07-23/1997-07-24/1997-07-25/1997-07-26/1997-07-27/1997-07-28/1997-07-29/1997-07-30/1997-07-31/1997-08-01/1997-08-02/1997-08-03/1997-08-04/1997-08-05/1997-08-06/1997-08-07/1997-08-08/1997-08-09/1997-08-10/1997-08-11/1997-08-12/1997-08-13/1997-08-14/1997-08-15/1997-08-16/1997-08-17/1997-08-18/1997-08-19/1997-08-20/1997-08-21/1997-08-22/1997-08-23/1997-08-24/1997-08-25/1997-08-26/1997-08-27/1997-08-28/1997-08-29/1997-08-30/1997-08-31/1997-12-01/1997-12-02/1997-12-03/1997-12-04/1997-12-05/1997-12-06/1997-12-07/1997-12-08/1997-12-09/1997-12-10/1997-12-11/1997-12-12/1997-12-13/1997-12-14/1997-12-15/1997-12-16/1997-12-17/1997-12-18/1997-12-19/1997-12-20/1997-12-21/1997-12-22/1997-12-23/1997-12-24/1997-12-25/1997-12-26/1997-12-27/1997-12-28/1997-12-29/1997-12-30/1997-12-31/1998-01-01/1998-01-02/1998-01-03/1998-01-04/1998-01-05/1998-01-06/1998-01-07/1998-01-08/1998-01-09/1998-01-10/1998-01-11/1998-01-12/1998-01-13/1998-01-14/1998-01-15/1998-01-16/1998-01-17/1998-01-18/1998-01-19/1998-01-20/1998-01-21/1998-01-22/1998-01-23/1998-01-24/1998-01-25/1998-01-26/1998-01-27/1998-01-28/1998-01-29/1998-01-30/1998-01-31/1998-02-01/1998-02-02/1998-02-03/1998-02-04/1998-02-05/1998-02-06/1998-02-07/1998-02-08/1998-02-09/1998-02-10/1998-02-11/1998-02-12/1998-02-13/1998-02-14/1998-02-15/1998-02-16/1998-02-17/1998-02-18/1998-02-19/1998-02-20/1998-02-21/1998-02-22/1998-02-23/1998-02-24/1998-02-25/1998-02-26/1998-02-27/1998-02-28/1998-06-01/1998-06-02/1998-06-03/1998-06-04/1998-06-05/1998-06-06/1998-06-07/1998-06-08/1998-06-09/1998-06-10/1998-06-11/1998-06-12/1998-06-13/1998-06-14/1998-06-15/1998-06-16/1998-06-17/1998-06-18/1998-06-19/1998-06-20/1998-06-21/1998-06-22/1998-06-23/1998-06-24/1998-06-25/1998-06-26/1998-06-27/1998-06-28/1998-06-29/1998-06-30/1998-07-01/1998-07-02/1998-07-03/1998-07-04/1998-07-05/1998-07-06/1998-07-07/1998-07-08/1998-07-09/1998-07-10/1998-07-11/1998-07-12/1998-07-13/1998-07-14/1998-07-15/1998-07-16/1998-07-17/1998-07-18/1998-07-19/1998-07-20/1998-07-21/1998-07-22/1998-07-23/1998-07-24/1998-07-25/1998-07-26/1998-07-27/1998-07-28/1998-07-29/1998-07-30/1998-07-31/1998-08-01/1998-08-02/1998-08-03/1998-08-04/1998-08-05/1998-08-06/1998-08-07/1998-08-08/1998-08-09/1998-08-10/1998-08-11/1998-08-12/1998-08-13/1998-08-14/1998-08-15/1998-08-16/1998-08-17/1998-08-18/1998-08-19/1998-08-20/1998-08-21/1998-08-22/1998-08-23/1998-08-24/1998-08-25/1998-08-26/1998-08-27/1998-08-28/1998-08-29/1998-08-30/1998-08-31/1998-12-01/1998-12-02/1998-12-03/1998-12-04/1998-12-05/1998-12-06/1998-12-07/1998-12-08/1998-12-09/1998-12-10/1998-12-11/1998-12-12/1998-12-13/1998-12-14/1998-12-15/1998-12-16/1998-12-17/1998-12-18/1998-12-19/1998-12-20/1998-12-21/1998-12-22/1998-12-23/1998-12-24/1998-12-25/1998-12-26/1998-12-27/1998-12-28/1998-12-29/1998-12-30/1998-12-31/1999-01-01/1999-01-02/1999-01-03/1999-01-04/1999-01-05/1999-01-06/1999-01-07/1999-01-08/1999-01-09/1999-01-10/1999-01-11/1999-01-12/1999-01-13/1999-01-14/1999-01-15/1999-01-16/1999-01-17/1999-01-18/1999-01-19/1999-01-20/1999-01-21/1999-01-22/1999-01-23/1999-01-24/1999-01-25/1999-01-26/1999-01-27/1999-01-28/1999-01-29/1999-01-30/1999-01-31/1999-02-01/1999-02-02/1999-02-03/1999-02-04/1999-02-05/1999-02-06/1999-02-07/1999-02-08/1999-02-09/1999-02-10/1999-02-11/1999-02-12/1999-02-13/1999-02-14/1999-02-15/1999-02-16/1999-02-17/1999-02-18/1999-02-19/1999-02-20/1999-02-21/1999-02-22/1999-02-23/1999-02-24/1999-02-25/1999-02-26/1999-02-27/1999-02-28/1999-06-01/1999-06-02/1999-06-03/1999-06-04/1999-06-05/1999-06-06/1999-06-07/1999-06-08/1999-06-09/1999-06-10/1999-06-11/1999-06-12/1999-06-13/1999-06-14/1999-06-15/1999-06-16/1999-06-17/1999-06-18/1999-06-19/1999-06-20/1999-06-21/1999-06-22/1999-06-23/1999-06-24/1999-06-25/1999-06-26/1999-06-27/1999-06-28/1999-06-29/1999-06-30/1999-07-01/1999-07-02/1999-07-03/1999-07-04/1999-07-05/1999-07-06/1999-07-07/1999-07-08/1999-07-09/1999-07-10/1999-07-11/1999-07-12/1999-07-13/1999-07-14/1999-07-15/1999-07-16/1999-07-17/1999-07-18/1999-07-19/1999-07-20/1999-07-21/1999-07-22/1999-07-23/1999-07-24/1999-07-25/1999-07-26/1999-07-27/1999-07-28/1999-07-29/1999-07-30/1999-07-31/1999-08-01/1999-08-02/1999-08-03/1999-08-04/1999-08-05/1999-08-06/1999-08-07/1999-08-08/1999-08-09/1999-08-10/1999-08-11/1999-08-12/1999-08-13/1999-08-14/1999-08-15/1999-08-16/1999-08-17/1999-08-18/1999-08-19/1999-08-20/1999-08-21/1999-08-22/1999-08-23/1999-08-24/1999-08-25/1999-08-26/1999-08-27/1999-08-28/1999-08-29/1999-08-30/1999-08-31/1999-12-01/1999-12-02/1999-12-03/1999-12-04/1999-12-05/1999-12-06/1999-12-07/1999-12-08/1999-12-09/1999-12-10/1999-12-11/1999-12-12/1999-12-13/1999-12-14/1999-12-15/1999-12-16/1999-12-17/1999-12-18/1999-12-19/1999-12-20/1999-12-21/1999-12-22/1999-12-23/1999-12-24/1999-12-25/1999-12-26/1999-12-27/1999-12-28/1999-12-29/1999-12-30/1999-12-31/2000-01-01/2000-01-02/2000-01-03/2000-01-04/2000-01-05/2000-01-06/2000-01-07/2000-01-08/2000-01-09/2000-01-10/2000-01-11/2000-01-12/2000-01-13/2000-01-14/2000-01-15/2000-01-16/2000-01-17/2000-01-18/2000-01-19/2000-01-20/2000-01-21/2000-01-22/2000-01-23/2000-01-24/2000-01-25/2000-01-26/2000-01-27/2000-01-28/2000-01-29/2000-01-30/2000-01-31/2000-02-01/2000-02-02/2000-02-03/2000-02-04/2000-02-05/2000-02-06/2000-02-07/2000-02-08/2000-02-09/2000-02-10/2000-02-11/2000-02-12/2000-02-13/2000-02-14/2000-02-15/2000-02-16/2000-02-17/2000-02-18/2000-02-19/2000-02-20/2000-02-21/2000-02-22/2000-02-23/2000-02-24/2000-02-25/2000-02-26/2000-02-27/2000-02-28/2000-02-29/2000-06-01/2000-06-02/2000-06-03/2000-06-04/2000-06-05/2000-06-06/2000-06-07/2000-06-08/2000-06-09/2000-06-10/2000-06-11/2000-06-12/2000-06-13/2000-06-14/2000-06-15/2000-06-16/2000-06-17/2000-06-18/2000-06-19/2000-06-20/2000-06-21/2000-06-22/2000-06-23/2000-06-24/2000-06-25/2000-06-26/2000-06-27/2000-06-28/2000-06-29/2000-06-30/2000-07-01/2000-07-02/2000-07-03/2000-07-04/2000-07-05/2000-07-06/2000-07-07/2000-07-08/2000-07-09/2000-07-10/2000-07-11/2000-07-12/2000-07-13/2000-07-14/2000-07-15/2000-07-16/2000-07-17/2000-07-18/2000-07-19/2000-07-20/2000-07-21/2000-07-22/2000-07-23/2000-07-24/2000-07-25/2000-07-26/2000-07-27/2000-07-28/2000-07-29/2000-07-30/2000-07-31/2000-08-01/2000-08-02/2000-08-03/2000-08-04/2000-08-05/2000-08-06/2000-08-07/2000-08-08/2000-08-09/2000-08-10/2000-08-11/2000-08-12/2000-08-13/2000-08-14/2000-08-15/2000-08-16/2000-08-17/2000-08-18/2000-08-19/2000-08-20/2000-08-21/2000-08-22/2000-08-23/2000-08-24/2000-08-25/2000-08-26/2000-08-27/2000-08-28/2000-08-29/2000-08-30/2000-08-31/2000-12-01/2000-12-02/2000-12-03/2000-12-04/2000-12-05/2000-12-06/2000-12-07/2000-12-08/2000-12-09/2000-12-10/2000-12-11/2000-12-12/2000-12-13/2000-12-14/2000-12-15/2000-12-16/2000-12-17/2000-12-18/2000-12-19/2000-12-20/2000-12-21/2000-12-22/2000-12-23/2000-12-24/2000-12-25/2000-12-26/2000-12-27/2000-12-28/2000-12-29/2000-12-30/2000-12-31/2001-01-01/2001-01-02/2001-01-03/2001-01-04/2001-01-05/2001-01-06/2001-01-07/2001-01-08/2001-01-09/2001-01-10/2001-01-11/2001-01-12/2001-01-13/2001-01-14/2001-01-15/2001-01-16/2001-01-17/2001-01-18/2001-01-19/2001-01-20/2001-01-21/2001-01-22/2001-01-23/2001-01-24/2001-01-25/2001-01-26/2001-01-27/2001-01-28/2001-01-29/2001-01-30/2001-01-31/2001-02-01/2001-02-02/2001-02-03/2001-02-04/2001-02-05/2001-02-06/2001-02-07/2001-02-08/2001-02-09/2001-02-10/2001-02-11/2001-02-12/2001-02-13/2001-02-14/2001-02-15/2001-02-16/2001-02-17/2001-02-18/2001-02-19/2001-02-20/2001-02-21/2001-02-22/2001-02-23/2001-02-24/2001-02-25/2001-02-26/2001-02-27/2001-02-28/2001-06-01/2001-06-02/2001-06-03/2001-06-04/2001-06-05/2001-06-06/2001-06-07/2001-06-08/2001-06-09/2001-06-10/2001-06-11/2001-06-12/2001-06-13/2001-06-14/2001-06-15/2001-06-16/2001-06-17/2001-06-18/2001-06-19/2001-06-20/2001-06-21/2001-06-22/2001-06-23/2001-06-24/2001-06-25/2001-06-26/2001-06-27/2001-06-28/2001-06-29/2001-06-30/2001-07-01/2001-07-02/2001-07-03/2001-07-04/2001-07-05/2001-07-06/2001-07-07/2001-07-08/2001-07-09/2001-07-10/2001-07-11/2001-07-12/2001-07-13/2001-07-14/2001-07-15/2001-07-16/2001-07-17/2001-07-18/2001-07-19/2001-07-20/2001-07-21/2001-07-22/2001-07-23/2001-07-24/2001-07-25/2001-07-26/2001-07-27/2001-07-28/2001-07-29/2001-07-30/2001-07-31/2001-08-01/2001-08-02/2001-08-03/2001-08-04/2001-08-05/2001-08-06/2001-08-07/2001-08-08/2001-08-09/2001-08-10/2001-08-11/2001-08-12/2001-08-13/2001-08-14/2001-08-15/2001-08-16/2001-08-17/2001-08-18/2001-08-19/2001-08-20/2001-08-21/2001-08-22/2001-08-23/2001-08-24/2001-08-25/2001-08-26/2001-08-27/2001-08-28/2001-08-29/2001-08-30/2001-08-31/2001-12-01/2001-12-02/2001-12-03/2001-12-04/2001-12-05/2001-12-06/2001-12-07/2001-12-08/2001-12-09/2001-12-10/2001-12-11/2001-12-12/2001-12-13/2001-12-14/2001-12-15/2001-12-16/2001-12-17/2001-12-18/2001-12-19/2001-12-20/2001-12-21/2001-12-22/2001-12-23/2001-12-24/2001-12-25/2001-12-26/2001-12-27/2001-12-28/2001-12-29/2001-12-30/2001-12-31/2002-01-01/2002-01-02/2002-01-03/2002-01-04/2002-01-05/2002-01-06/2002-01-07/2002-01-08/2002-01-09/2002-01-10/2002-01-11/2002-01-12/2002-01-13/2002-01-14/2002-01-15/2002-01-16/2002-01-17/2002-01-18/2002-01-19/2002-01-20/2002-01-21/2002-01-22/2002-01-23/2002-01-24/2002-01-25/2002-01-26/2002-01-27/2002-01-28/2002-01-29/2002-01-30/2002-01-31/2002-02-01/2002-02-02/2002-02-03/2002-02-04/2002-02-05/2002-02-06/2002-02-07/2002-02-08/2002-02-09/2002-02-10/2002-02-11/2002-02-12/2002-02-13/2002-02-14/2002-02-15/2002-02-16/2002-02-17/2002-02-18/2002-02-19/2002-02-20/2002-02-21/2002-02-22/2002-02-23/2002-02-24/2002-02-25/2002-02-26/2002-02-27/2002-02-28/2002-06-01/2002-06-02/2002-06-03/2002-06-04/2002-06-05/2002-06-06/2002-06-07/2002-06-08/2002-06-09/2002-06-10/2002-06-11/2002-06-12/2002-06-13/2002-06-14/2002-06-15/2002-06-16/2002-06-17/2002-06-18/2002-06-19/2002-06-20/2002-06-21/2002-06-22/2002-06-23/2002-06-24/2002-06-25/2002-06-26/2002-06-27/2002-06-28/2002-06-29/2002-06-30/2002-07-01/2002-07-02/2002-07-03/2002-07-04/2002-07-05/2002-07-06/2002-07-07/2002-07-08/2002-07-09/2002-07-10/2002-07-11/2002-07-12/2002-07-13/2002-07-14/2002-07-15/2002-07-16/2002-07-17/2002-07-18/2002-07-19/2002-07-20/2002-07-21/2002-07-22/2002-07-23/2002-07-24/2002-07-25/2002-07-26/2002-07-27/2002-07-28/2002-07-29/2002-07-30/2002-07-31/2002-08-01/2002-08-02/2002-08-03/2002-08-04/2002-08-05/2002-08-06/2002-08-07/2002-08-08/2002-08-09/2002-08-10/2002-08-11/2002-08-12/2002-08-13/2002-08-14/2002-08-15/2002-08-16/2002-08-17/2002-08-18/2002-08-19/2002-08-20/2002-08-21/2002-08-22/2002-08-23/2002-08-24/2002-08-25/2002-08-26/2002-08-27/2002-08-28/2002-08-29/2002-08-30/2002-08-31/2002-12-01/2002-12-02/2002-12-03/2002-12-04/2002-12-05/2002-12-06/2002-12-07/2002-12-08/2002-12-09/2002-12-10/2002-12-11/2002-12-12/2002-12-13/2002-12-14/2002-12-15/2002-12-16/2002-12-17/2002-12-18/2002-12-19/2002-12-20/2002-12-21/2002-12-22/2002-12-23/2002-12-24/2002-12-25/2002-12-26/2002-12-27/2002-12-28/2002-12-29/2002-12-30/2002-12-31/2003-01-01/2003-01-02/2003-01-03/2003-01-04/2003-01-05/2003-01-06/2003-01-07/2003-01-08/2003-01-09/2003-01-10/2003-01-11/2003-01-12/2003-01-13/2003-01-14/2003-01-15/2003-01-16/2003-01-17/2003-01-18/2003-01-19/2003-01-20/2003-01-21/2003-01-22/2003-01-23/2003-01-24/2003-01-25/2003-01-26/2003-01-27/2003-01-28/2003-01-29/2003-01-30/2003-01-31/2003-02-01/2003-02-02/2003-02-03/2003-02-04/2003-02-05/2003-02-06/2003-02-07/2003-02-08/2003-02-09/2003-02-10/2003-02-11/2003-02-12/2003-02-13/2003-02-14/2003-02-15/2003-02-16/2003-02-17/2003-02-18/2003-02-19/2003-02-20/2003-02-21/2003-02-22/2003-02-23/2003-02-24/2003-02-25/2003-02-26/2003-02-27/2003-02-28/2003-06-01/2003-06-02/2003-06-03/2003-06-04/2003-06-05/2003-06-06/2003-06-07/2003-06-08/2003-06-09/2003-06-10/2003-06-11/2003-06-12/2003-06-13/2003-06-14/2003-06-15/2003-06-16/2003-06-17/2003-06-18/2003-06-19/2003-06-20/2003-06-21/2003-06-22/2003-06-23/2003-06-24/2003-06-25/2003-06-26/2003-06-27/2003-06-28/2003-06-29/2003-06-30/2003-07-01/2003-07-02/2003-07-03/2003-07-04/2003-07-05/2003-07-06/2003-07-07/2003-07-08/2003-07-09/2003-07-10/2003-07-11/2003-07-12/2003-07-13/2003-07-14/2003-07-15/2003-07-16/2003-07-17/2003-07-18/2003-07-19/2003-07-20/2003-07-21/2003-07-22/2003-07-23/2003-07-24/2003-07-25/2003-07-26/2003-07-27/2003-07-28/2003-07-29/2003-07-30/2003-07-31/2003-08-01/2003-08-02/2003-08-03/2003-08-04/2003-08-05/2003-08-06/2003-08-07/2003-08-08/2003-08-09/2003-08-10/2003-08-11/2003-08-12/2003-08-13/2003-08-14/2003-08-15/2003-08-16/2003-08-17/2003-08-18/2003-08-19/2003-08-20/2003-08-21/2003-08-22/2003-08-23/2003-08-24/2003-08-25/2003-08-26/2003-08-27/2003-08-28/2003-08-29/2003-08-30/2003-08-31/2003-12-01/2003-12-02/2003-12-03/2003-12-04/2003-12-05/2003-12-06/2003-12-07/2003-12-08/2003-12-09/2003-12-10/2003-12-11/2003-12-12/2003-12-13/2003-12-14/2003-12-15/2003-12-16/2003-12-17/2003-12-18/2003-12-19/2003-12-20/2003-12-21/2003-12-22/2003-12-23/2003-12-24/2003-12-25/2003-12-26/2003-12-27/2003-12-28/2003-12-29/2003-12-30/2003-12-31/2004-01-01/2004-01-02/2004-01-03/2004-01-04/2004-01-05/2004-01-06/2004-01-07/2004-01-08/2004-01-09/2004-01-10/2004-01-11/2004-01-12/2004-01-13/2004-01-14/2004-01-15/2004-01-16/2004-01-17/2004-01-18/2004-01-19/2004-01-20/2004-01-21/2004-01-22/2004-01-23/2004-01-24/2004-01-25/2004-01-26/2004-01-27/2004-01-28/2004-01-29/2004-01-30/2004-01-31/2004-02-01/2004-02-02/2004-02-03/2004-02-04/2004-02-05/2004-02-06/2004-02-07/2004-02-08/2004-02-09/2004-02-10/2004-02-11/2004-02-12/2004-02-13/2004-02-14/2004-02-15/2004-02-16/2004-02-17/2004-02-18/2004-02-19/2004-02-20/2004-02-21/2004-02-22/2004-02-23/2004-02-24/2004-02-25/2004-02-26/2004-02-27/2004-02-28/2004-02-29/2004-06-01/2004-06-02/2004-06-03/2004-06-04/2004-06-05/2004-06-06/2004-06-07/2004-06-08/2004-06-09/2004-06-10/2004-06-11/2004-06-12/2004-06-13/2004-06-14/2004-06-15/2004-06-16/2004-06-17/2004-06-18/2004-06-19/2004-06-20/2004-06-21/2004-06-22/2004-06-23/2004-06-24/2004-06-25/2004-06-26/2004-06-27/2004-06-28/2004-06-29/2004-06-30/2004-07-01/2004-07-02/2004-07-03/2004-07-04/2004-07-05/2004-07-06/2004-07-07/2004-07-08/2004-07-09/2004-07-10/2004-07-11/2004-07-12/2004-07-13/2004-07-14/2004-07-15/2004-07-16/2004-07-17/2004-07-18/2004-07-19/2004-07-20/2004-07-21/2004-07-22/2004-07-23/2004-07-24/2004-07-25/2004-07-26/2004-07-27/2004-07-28/2004-07-29/2004-07-30/2004-07-31/2004-08-01/2004-08-02/2004-08-03/2004-08-04/2004-08-05/2004-08-06/2004-08-07/2004-08-08/2004-08-09/2004-08-10/2004-08-11/2004-08-12/2004-08-13/2004-08-14/2004-08-15/2004-08-16/2004-08-17/2004-08-18/2004-08-19/2004-08-20/2004-08-21/2004-08-22/2004-08-23/2004-08-24/2004-08-25/2004-08-26/2004-08-27/2004-08-28/2004-08-29/2004-08-30/2004-08-31/2004-12-01/2004-12-02/2004-12-03/2004-12-04/2004-12-05/2004-12-06/2004-12-07/2004-12-08/2004-12-09/2004-12-10/2004-12-11/2004-12-12/2004-12-13/2004-12-14/2004-12-15/2004-12-16/2004-12-17/2004-12-18/2004-12-19/2004-12-20/2004-12-21/2004-12-22/2004-12-23/2004-12-24/2004-12-25/2004-12-26/2004-12-27/2004-12-28/2004-12-29/2004-12-30/2004-12-31/2005-01-01/2005-01-02/2005-01-03/2005-01-04/2005-01-05/2005-01-06/2005-01-07/2005-01-08/2005-01-09/2005-01-10/2005-01-11/2005-01-12/2005-01-13/2005-01-14/2005-01-15/2005-01-16/2005-01-17/2005-01-18/2005-01-19/2005-01-20/2005-01-21/2005-01-22/2005-01-23/2005-01-24/2005-01-25/2005-01-26/2005-01-27/2005-01-28/2005-01-29/2005-01-30/2005-01-31/2005-02-01/2005-02-02/2005-02-03/2005-02-04/2005-02-05/2005-02-06/2005-02-07/2005-02-08/2005-02-09/2005-02-10/2005-02-11/2005-02-12/2005-02-13/2005-02-14/2005-02-15/2005-02-16/2005-02-17/2005-02-18/2005-02-19/2005-02-20/2005-02-21/2005-02-22/2005-02-23/2005-02-24/2005-02-25/2005-02-26/2005-02-27/2005-02-28/2005-06-01/2005-06-02/2005-06-03/2005-06-04/2005-06-05/2005-06-06/2005-06-07/2005-06-08/2005-06-09/2005-06-10/2005-06-11/2005-06-12/2005-06-13/2005-06-14/2005-06-15/2005-06-16/2005-06-17/2005-06-18/2005-06-19/2005-06-20/2005-06-21/2005-06-22/2005-06-23/2005-06-24/2005-06-25/2005-06-26/2005-06-27/2005-06-28/2005-06-29/2005-06-30/2005-07-01/2005-07-02/2005-07-03/2005-07-04/2005-07-05/2005-07-06/2005-07-07/2005-07-08/2005-07-09/2005-07-10/2005-07-11/2005-07-12/2005-07-13/2005-07-14/2005-07-15/2005-07-16/2005-07-17/2005-07-18/2005-07-19/2005-07-20/2005-07-21/2005-07-22/2005-07-23/2005-07-24/2005-07-25/2005-07-26/2005-07-27/2005-07-28/2005-07-29/2005-07-30/2005-07-31/2005-08-01/2005-08-02/2005-08-03/2005-08-04/2005-08-05/2005-08-06/2005-08-07/2005-08-08/2005-08-09/2005-08-10/2005-08-11/2005-08-12/2005-08-13/2005-08-14/2005-08-15/2005-08-16/2005-08-17/2005-08-18/2005-08-19/2005-08-20/2005-08-21/2005-08-22/2005-08-23/2005-08-24/2005-08-25/2005-08-26/2005-08-27/2005-08-28/2005-08-29/2005-08-30/2005-08-31/2005-12-01/2005-12-02/2005-12-03/2005-12-04/2005-12-05/2005-12-06/2005-12-07/2005-12-08/2005-12-09/2005-12-10/2005-12-11/2005-12-12/2005-12-13/2005-12-14/2005-12-15/2005-12-16/2005-12-17/2005-12-18/2005-12-19/2005-12-20/2005-12-21/2005-12-22/2005-12-23/2005-12-24/2005-12-25/2005-12-26/2005-12-27/2005-12-28/2005-12-29/2005-12-30/2005-12-31/2006-01-01/2006-01-02/2006-01-03/2006-01-04/2006-01-05/2006-01-06/2006-01-07/2006-01-08/2006-01-09/2006-01-10/2006-01-11/2006-01-12/2006-01-13/2006-01-14/2006-01-15/2006-01-16/2006-01-17/2006-01-18/2006-01-19/2006-01-20/2006-01-21/2006-01-22/2006-01-23/2006-01-24/2006-01-25/2006-01-26/2006-01-27/2006-01-28/2006-01-29/2006-01-30/2006-01-31/2006-02-01/2006-02-02/2006-02-03/2006-02-04/2006-02-05/2006-02-06/2006-02-07/2006-02-08/2006-02-09/2006-02-10/2006-02-11/2006-02-12/2006-02-13/2006-02-14/2006-02-15/2006-02-16/2006-02-17/2006-02-18/2006-02-19/2006-02-20/2006-02-21/2006-02-22/2006-02-23/2006-02-24/2006-02-25/2006-02-26/2006-02-27/2006-02-28/2006-06-01/2006-06-02/2006-06-03/2006-06-04/2006-06-05/2006-06-06/2006-06-07/2006-06-08/2006-06-09/2006-06-10/2006-06-11/2006-06-12/2006-06-13/2006-06-14/2006-06-15/2006-06-16/2006-06-17/2006-06-18/2006-06-19/2006-06-20/2006-06-21/2006-06-22/2006-06-23/2006-06-24/2006-06-25/2006-06-26/2006-06-27/2006-06-28/2006-06-29/2006-06-30/2006-07-01/2006-07-02/2006-07-03/2006-07-04/2006-07-05/2006-07-06/2006-07-07/2006-07-08/2006-07-09/2006-07-10/2006-07-11/2006-07-12/2006-07-13/2006-07-14/2006-07-15/2006-07-16/2006-07-17/2006-07-18/2006-07-19/2006-07-20/2006-07-21/2006-07-22/2006-07-23/2006-07-24/2006-07-25/2006-07-26/2006-07-27/2006-07-28/2006-07-29/2006-07-30/2006-07-31/2006-08-01/2006-08-02/2006-08-03/2006-08-04/2006-08-05/2006-08-06/2006-08-07/2006-08-08/2006-08-09/2006-08-10/2006-08-11/2006-08-12/2006-08-13/2006-08-14/2006-08-15/2006-08-16/2006-08-17/2006-08-18/2006-08-19/2006-08-20/2006-08-21/2006-08-22/2006-08-23/2006-08-24/2006-08-25/2006-08-26/2006-08-27/2006-08-28/2006-08-29/2006-08-30/2006-08-31/2006-12-01/2006-12-02/2006-12-03/2006-12-04/2006-12-05/2006-12-06/2006-12-07/2006-12-08/2006-12-09/2006-12-10/2006-12-11/2006-12-12/2006-12-13/2006-12-14/2006-12-15/2006-12-16/2006-12-17/2006-12-18/2006-12-19/2006-12-20/2006-12-21/2006-12-22/2006-12-23/2006-12-24/2006-12-25/2006-12-26/2006-12-27/2006-12-28/2006-12-29/2006-12-30/2006-12-31/2007-01-01/2007-01-02/2007-01-03/2007-01-04/2007-01-05/2007-01-06/2007-01-07/2007-01-08/2007-01-09/2007-01-10/2007-01-11/2007-01-12/2007-01-13/2007-01-14/2007-01-15/2007-01-16/2007-01-17/2007-01-18/2007-01-19/2007-01-20/2007-01-21/2007-01-22/2007-01-23/2007-01-24/2007-01-25/2007-01-26/2007-01-27/2007-01-28/2007-01-29/2007-01-30/2007-01-31/2007-02-01/2007-02-02/2007-02-03/2007-02-04/2007-02-05/2007-02-06/2007-02-07/2007-02-08/2007-02-09/2007-02-10/2007-02-11/2007-02-12/2007-02-13/2007-02-14/2007-02-15/2007-02-16/2007-02-17/2007-02-18/2007-02-19/2007-02-20/2007-02-21/2007-02-22/2007-02-23/2007-02-24/2007-02-25/2007-02-26/2007-02-27/2007-02-28/2007-06-01/2007-06-02/2007-06-03/2007-06-04/2007-06-05/2007-06-06/2007-06-07/2007-06-08/2007-06-09/2007-06-10/2007-06-11/2007-06-12/2007-06-13/2007-06-14/2007-06-15/2007-06-16/2007-06-17/2007-06-18/2007-06-19/2007-06-20/2007-06-21/2007-06-22/2007-06-23/2007-06-24/2007-06-25/2007-06-26/2007-06-27/2007-06-28/2007-06-29/2007-06-30/2007-07-01/2007-07-02/2007-07-03/2007-07-04/2007-07-05/2007-07-06/2007-07-07/2007-07-08/2007-07-09/2007-07-10/2007-07-11/2007-07-12/2007-07-13/2007-07-14/2007-07-15/2007-07-16/2007-07-17/2007-07-18/2007-07-19/2007-07-20/2007-07-21/2007-07-22/2007-07-23/2007-07-24/2007-07-25/2007-07-26/2007-07-27/2007-07-28/2007-07-29/2007-07-30/2007-07-31/2007-08-01/2007-08-02/2007-08-03/2007-08-04/2007-08-05/2007-08-06/2007-08-07/2007-08-08/2007-08-09/2007-08-10/2007-08-11/2007-08-12/2007-08-13/2007-08-14/2007-08-15/2007-08-16/2007-08-17/2007-08-18/2007-08-19/2007-08-20/2007-08-21/2007-08-22/2007-08-23/2007-08-24/2007-08-25/2007-08-26/2007-08-27/2007-08-28/2007-08-29/2007-08-30/2007-08-31/2007-12-01/2007-12-02/2007-12-03/2007-12-04/2007-12-05/2007-12-06/2007-12-07/2007-12-08/2007-12-09/2007-12-10/2007-12-11/2007-12-12/2007-12-13/2007-12-14/2007-12-15/2007-12-16/2007-12-17/2007-12-18/2007-12-19/2007-12-20/2007-12-21/2007-12-22/2007-12-23/2007-12-24/2007-12-25/2007-12-26/2007-12-27/2007-12-28/2007-12-29/2007-12-30/2007-12-31/2008-01-01/2008-01-02/2008-01-03/2008-01-04/2008-01-05/2008-01-06/2008-01-07/2008-01-08/2008-01-09/2008-01-10/2008-01-11/2008-01-12/2008-01-13/2008-01-14/2008-01-15/2008-01-16/2008-01-17/2008-01-18/2008-01-19/2008-01-20/2008-01-21/2008-01-22/2008-01-23/2008-01-24/2008-01-25/2008-01-26/2008-01-27/2008-01-28/2008-01-29/2008-01-30/2008-01-31/2008-02-01/2008-02-02/2008-02-03/2008-02-04/2008-02-05/2008-02-06/2008-02-07/2008-02-08/2008-02-09/2008-02-10/2008-02-11/2008-02-12/2008-02-13/2008-02-14/2008-02-15/2008-02-16/2008-02-17/2008-02-18/2008-02-19/2008-02-20/2008-02-21/2008-02-22/2008-02-23/2008-02-24/2008-02-25/2008-02-26/2008-02-27/2008-02-28/2008-02-29/2008-06-01/2008-06-02/2008-06-03/2008-06-04/2008-06-05/2008-06-06/2008-06-07/2008-06-08/2008-06-09/2008-06-10/2008-06-11/2008-06-12/2008-06-13/2008-06-14/2008-06-15/2008-06-16/2008-06-17/2008-06-18/2008-06-19/2008-06-20/2008-06-21/2008-06-22/2008-06-23/2008-06-24/2008-06-25/2008-06-26/2008-06-27/2008-06-28/2008-06-29/2008-06-30/2008-07-01/2008-07-02/2008-07-03/2008-07-04/2008-07-05/2008-07-06/2008-07-07/2008-07-08/2008-07-09/2008-07-10/2008-07-11/2008-07-12/2008-07-13/2008-07-14/2008-07-15/2008-07-16/2008-07-17/2008-07-18/2008-07-19/2008-07-20/2008-07-21/2008-07-22/2008-07-23/2008-07-24/2008-07-25/2008-07-26/2008-07-27/2008-07-28/2008-07-29/2008-07-30/2008-07-31/2008-08-01/2008-08-02/2008-08-03/2008-08-04/2008-08-05/2008-08-06/2008-08-07/2008-08-08/2008-08-09/2008-08-10/2008-08-11/2008-08-12/2008-08-13/2008-08-14/2008-08-15/2008-08-16/2008-08-17/2008-08-18/2008-08-19/2008-08-20/2008-08-21/2008-08-22/2008-08-23/2008-08-24/2008-08-25/2008-08-26/2008-08-27/2008-08-28/2008-08-29/2008-08-30/2008-08-31/2008-12-01/2008-12-02/2008-12-03/2008-12-04/2008-12-05/2008-12-06/2008-12-07/2008-12-08/2008-12-09/2008-12-10/2008-12-11/2008-12-12/2008-12-13/2008-12-14/2008-12-15/2008-12-16/2008-12-17/2008-12-18/2008-12-19/2008-12-20/2008-12-21/2008-12-22/2008-12-23/2008-12-24/2008-12-25/2008-12-26/2008-12-27/2008-12-28/2008-12-29/2008-12-30/2008-12-31/2009-01-01/2009-01-02/2009-01-03/2009-01-04/2009-01-05/2009-01-06/2009-01-07/2009-01-08/2009-01-09/2009-01-10/2009-01-11/2009-01-12/2009-01-13/2009-01-14/2009-01-15/2009-01-16/2009-01-17/2009-01-18/2009-01-19/2009-01-20/2009-01-21/2009-01-22/2009-01-23/2009-01-24/2009-01-25/2009-01-26/2009-01-27/2009-01-28/2009-01-29/2009-01-30/2009-01-31/2009-02-01/2009-02-02/2009-02-03/2009-02-04/2009-02-05/2009-02-06/2009-02-07/2009-02-08/2009-02-09/2009-02-10/2009-02-11/2009-02-12/2009-02-13/2009-02-14/2009-02-15/2009-02-16/2009-02-17/2009-02-18/2009-02-19/2009-02-20/2009-02-21/2009-02-22/2009-02-23/2009-02-24/2009-02-25/2009-02-26/2009-02-27/2009-02-28/2009-06-01/2009-06-02/2009-06-03/2009-06-04/2009-06-05/2009-06-06/2009-06-07/2009-06-08/2009-06-09/2009-06-10/2009-06-11/2009-06-12/2009-06-13/2009-06-14/2009-06-15/2009-06-16/2009-06-17/2009-06-18/2009-06-19/2009-06-20/2009-06-21/2009-06-22/2009-06-23/2009-06-24/2009-06-25/2009-06-26/2009-06-27/2009-06-28/2009-06-29/2009-06-30/2009-07-01/2009-07-02/2009-07-03/2009-07-04/2009-07-05/2009-07-06/2009-07-07/2009-07-08/2009-07-09/2009-07-10/2009-07-11/2009-07-12/2009-07-13/2009-07-14/2009-07-15/2009-07-16/2009-07-17/2009-07-18/2009-07-19/2009-07-20/2009-07-21/2009-07-22/2009-07-23/2009-07-24/2009-07-25/2009-07-26/2009-07-27/2009-07-28/2009-07-29/2009-07-30/2009-07-31/2009-08-01/2009-08-02/2009-08-03/2009-08-04/2009-08-05/2009-08-06/2009-08-07/2009-08-08/2009-08-09/2009-08-10/2009-08-11/2009-08-12/2009-08-13/2009-08-14/2009-08-15/2009-08-16/2009-08-17/2009-08-18/2009-08-19/2009-08-20/2009-08-21/2009-08-22/2009-08-23/2009-08-24/2009-08-25/2009-08-26/2009-08-27/2009-08-28/2009-08-29/2009-08-30/2009-08-31/2009-12-01/2009-12-02/2009-12-03/2009-12-04/2009-12-05/2009-12-06/2009-12-07/2009-12-08/2009-12-09/2009-12-10/2009-12-11/2009-12-12/2009-12-13/2009-12-14/2009-12-15/2009-12-16/2009-12-17/2009-12-18/2009-12-19/2009-12-20/2009-12-21/2009-12-22/2009-12-23/2009-12-24/2009-12-25/2009-12-26/2009-12-27/2009-12-28/2009-12-29/2009-12-30/2009-12-31/2010-01-01/2010-01-02/2010-01-03/2010-01-04/2010-01-05/2010-01-06/2010-01-07/2010-01-08/2010-01-09/2010-01-10/2010-01-11/2010-01-12/2010-01-13/2010-01-14/2010-01-15/2010-01-16/2010-01-17/2010-01-18/2010-01-19/2010-01-20/2010-01-21/2010-01-22/2010-01-23/2010-01-24/2010-01-25/2010-01-26/2010-01-27/2010-01-28/2010-01-29/2010-01-30/2010-01-31/2010-02-01/2010-02-02/2010-02-03/2010-02-04/2010-02-05/2010-02-06/2010-02-07/2010-02-08/2010-02-09/2010-02-10/2010-02-11/2010-02-12/2010-02-13/2010-02-14/2010-02-15/2010-02-16/2010-02-17/2010-02-18/2010-02-19/2010-02-20/2010-02-21/2010-02-22/2010-02-23/2010-02-24/2010-02-25/2010-02-26/2010-02-27/2010-02-28/2010-06-01/2010-06-02/2010-06-03/2010-06-04/2010-06-05/2010-06-06/2010-06-07/2010-06-08/2010-06-09/2010-06-10/2010-06-11/2010-06-12/2010-06-13/2010-06-14/2010-06-15/2010-06-16/2010-06-17/2010-06-18/2010-06-19/2010-06-20/2010-06-21/2010-06-22/2010-06-23/2010-06-24/2010-06-25/2010-06-26/2010-06-27/2010-06-28/2010-06-29/2010-06-30/2010-07-01/2010-07-02/2010-07-03/2010-07-04/2010-07-05/2010-07-06/2010-07-07/2010-07-08/2010-07-09/2010-07-10/2010-07-11/2010-07-12/2010-07-13/2010-07-14/2010-07-15/2010-07-16/2010-07-17/2010-07-18/2010-07-19/2010-07-20/2010-07-21/2010-07-22/2010-07-23/2010-07-24/2010-07-25/2010-07-26/2010-07-27/2010-07-28/2010-07-29/2010-07-30/2010-07-31/2010-08-01/2010-08-02/2010-08-03/2010-08-04/2010-08-05/2010-08-06/2010-08-07/2010-08-08/2010-08-09/2010-08-10/2010-08-11/2010-08-12/2010-08-13/2010-08-14/2010-08-15/2010-08-16/2010-08-17/2010-08-18/2010-08-19/2010-08-20/2010-08-21/2010-08-22/2010-08-23/2010-08-24/2010-08-25/2010-08-26/2010-08-27/2010-08-28/2010-08-29/2010-08-30/2010-08-31/2010-12-01/2010-12-02/2010-12-03/2010-12-04/2010-12-05/2010-12-06/2010-12-07/2010-12-08/2010-12-09/2010-12-10/2010-12-11/2010-12-12/2010-12-13/2010-12-14/2010-12-15/2010-12-16/2010-12-17/2010-12-18/2010-12-19/2010-12-20/2010-12-21/2010-12-22/2010-12-23/2010-12-24/2010-12-25/2010-12-26/2010-12-27/2010-12-28/2010-12-29/2010-12-30/2010-12-31/2011-01-01/2011-01-02/2011-01-03/2011-01-04/2011-01-05/2011-01-06/2011-01-07/2011-01-08/2011-01-09/2011-01-10/2011-01-11/2011-01-12/2011-01-13/2011-01-14/2011-01-15/2011-01-16/2011-01-17/2011-01-18/2011-01-19/2011-01-20/2011-01-21/2011-01-22/2011-01-23/2011-01-24/2011-01-25/2011-01-26/2011-01-27/2011-01-28/2011-01-29/2011-01-30/2011-01-31/2011-02-01/2011-02-02/2011-02-03/2011-02-04/2011-02-05/2011-02-06/2011-02-07/2011-02-08/2011-02-09/2011-02-10/2011-02-11/2011-02-12/2011-02-13/2011-02-14/2011-02-15/2011-02-16/2011-02-17/2011-02-18/2011-02-19/2011-02-20/2011-02-21/2011-02-22/2011-02-23/2011-02-24/2011-02-25/2011-02-26/2011-02-27/2011-02-28/2011-06-01/2011-06-02/2011-06-03/2011-06-04/2011-06-05/2011-06-06/2011-06-07/2011-06-08/2011-06-09/2011-06-10/2011-06-11/2011-06-12/2011-06-13/2011-06-14/2011-06-15/2011-06-16/2011-06-17/2011-06-18/2011-06-19/2011-06-20/2011-06-21/2011-06-22/2011-06-23/2011-06-24/2011-06-25/2011-06-26/2011-06-27/2011-06-28/2011-06-29/2011-06-30/2011-07-01/2011-07-02/2011-07-03/2011-07-04/2011-07-05/2011-07-06/2011-07-07/2011-07-08/2011-07-09/2011-07-10/2011-07-11/2011-07-12/2011-07-13/2011-07-14/2011-07-15/2011-07-16/2011-07-17/2011-07-18/2011-07-19/2011-07-20/2011-07-21/2011-07-22/2011-07-23/2011-07-24/2011-07-25/2011-07-26/2011-07-27/2011-07-28/2011-07-29/2011-07-30/2011-07-31/2011-08-01/2011-08-02/2011-08-03/2011-08-04/2011-08-05/2011-08-06/2011-08-07/2011-08-08/2011-08-09/2011-08-10/2011-08-11/2011-08-12/2011-08-13/2011-08-14/2011-08-15/2011-08-16/2011-08-17/2011-08-18/2011-08-19/2011-08-20/2011-08-21/2011-08-22/2011-08-23/2011-08-24/2011-08-25/2011-08-26/2011-08-27/2011-08-28/2011-08-29/2011-08-30/2011-08-31/2011-12-01/2011-12-02/2011-12-03/2011-12-04/2011-12-05/2011-12-06/2011-12-07/2011-12-08/2011-12-09/2011-12-10/2011-12-11/2011-12-12/2011-12-13/2011-12-14/2011-12-15/2011-12-16/2011-12-17/2011-12-18/2011-12-19/2011-12-20/2011-12-21/2011-12-22/2011-12-23/2011-12-24/2011-12-25/2011-12-26/2011-12-27/2011-12-28/2011-12-29/2011-12-30/2011-12-31/2012-01-01/2012-01-02/2012-01-03/2012-01-04/2012-01-05/2012-01-06/2012-01-07/2012-01-08/2012-01-09/2012-01-10/2012-01-11/2012-01-12/2012-01-13/2012-01-14/2012-01-15/2012-01-16/2012-01-17/2012-01-18/2012-01-19/2012-01-20/2012-01-21/2012-01-22/2012-01-23/2012-01-24/2012-01-25/2012-01-26/2012-01-27/2012-01-28/2012-01-29/2012-01-30/2012-01-31/2012-02-01/2012-02-02/2012-02-03/2012-02-04/2012-02-05/2012-02-06/2012-02-07/2012-02-08/2012-02-09/2012-02-10/2012-02-11/2012-02-12/2012-02-13/2012-02-14/2012-02-15/2012-02-16/2012-02-17/2012-02-18/2012-02-19/2012-02-20/2012-02-21/2012-02-22/2012-02-23/2012-02-24/2012-02-25/2012-02-26/2012-02-27/2012-02-28/2012-02-29/2012-06-01/2012-06-02/2012-06-03/2012-06-04/2012-06-05/2012-06-06/2012-06-07/2012-06-08/2012-06-09/2012-06-10/2012-06-11/2012-06-12/2012-06-13/2012-06-14/2012-06-15/2012-06-16/2012-06-17/2012-06-18/2012-06-19/2012-06-20/2012-06-21/2012-06-22/2012-06-23/2012-06-24/2012-06-25/2012-06-26/2012-06-27/2012-06-28/2012-06-29/2012-06-30/2012-07-01/2012-07-02/2012-07-03/2012-07-04/2012-07-05/2012-07-06/2012-07-07/2012-07-08/2012-07-09/2012-07-10/2012-07-11/2012-07-12/2012-07-13/2012-07-14/2012-07-15/2012-07-16/2012-07-17/2012-07-18/2012-07-19/2012-07-20/2012-07-21/2012-07-22/2012-07-23/2012-07-24/2012-07-25/2012-07-26/2012-07-27/2012-07-28/2012-07-29/2012-07-30/2012-07-31/2012-08-01/2012-08-02/2012-08-03/2012-08-04/2012-08-05/2012-08-06/2012-08-07/2012-08-08/2012-08-09/2012-08-10/2012-08-11/2012-08-12/2012-08-13/2012-08-14/2012-08-15/2012-08-16/2012-08-17/2012-08-18/2012-08-19/2012-08-20/2012-08-21/2012-08-22/2012-08-23/2012-08-24/2012-08-25/2012-08-26/2012-08-27/2012-08-28/2012-08-29/2012-08-30/2012-08-31/2012-12-01/2012-12-02/2012-12-03/2012-12-04/2012-12-05/2012-12-06/2012-12-07/2012-12-08/2012-12-09/2012-12-10/2012-12-11/2012-12-12/2012-12-13/2012-12-14/2012-12-15/2012-12-16/2012-12-17/2012-12-18/2012-12-19/2012-12-20/2012-12-21/2012-12-22/2012-12-23/2012-12-24/2012-12-25/2012-12-26/2012-12-27/2012-12-28/2012-12-29/2012-12-30/2012-12-31/2013-01-01/2013-01-02/2013-01-03/2013-01-04/2013-01-05/2013-01-06/2013-01-07/2013-01-08/2013-01-09/2013-01-10/2013-01-11/2013-01-12/2013-01-13/2013-01-14/2013-01-15/2013-01-16/2013-01-17/2013-01-18/2013-01-19/2013-01-20/2013-01-21/2013-01-22/2013-01-23/2013-01-24/2013-01-25/2013-01-26/2013-01-27/2013-01-28/2013-01-29/2013-01-30/2013-01-31/2013-02-01/2013-02-02/2013-02-03/2013-02-04/2013-02-05/2013-02-06/2013-02-07/2013-02-08/2013-02-09/2013-02-10/2013-02-11/2013-02-12/2013-02-13/2013-02-14/2013-02-15/2013-02-16/2013-02-17/2013-02-18/2013-02-19/2013-02-20/2013-02-21/2013-02-22/2013-02-23/2013-02-24/2013-02-25/2013-02-26/2013-02-27/2013-02-28/2013-06-01/2013-06-02/2013-06-03/2013-06-04/2013-06-05/2013-06-06/2013-06-07/2013-06-08/2013-06-09/2013-06-10/2013-06-11/2013-06-12/2013-06-13/2013-06-14/2013-06-15/2013-06-16/2013-06-17/2013-06-18/2013-06-19/2013-06-20/2013-06-21/2013-06-22/2013-06-23/2013-06-24/2013-06-25/2013-06-26/2013-06-27/2013-06-28/2013-06-29/2013-06-30/2013-07-01/2013-07-02/2013-07-03/2013-07-04/2013-07-05/2013-07-06/2013-07-07/2013-07-08/2013-07-09/2013-07-10/2013-07-11/2013-07-12/2013-07-13/2013-07-14/2013-07-15/2013-07-16/2013-07-17/2013-07-18/2013-07-19/2013-07-20/2013-07-21/2013-07-22/2013-07-23/2013-07-24/2013-07-25/2013-07-26/2013-07-27/2013-07-28/2013-07-29/2013-07-30/2013-07-31/2013-08-01/2013-08-02/2013-08-03/2013-08-04/2013-08-05/2013-08-06/2013-08-07/2013-08-08/2013-08-09/2013-08-10/2013-08-11/2013-08-12/2013-08-13/2013-08-14/2013-08-15/2013-08-16/2013-08-17/2013-08-18/2013-08-19/2013-08-20/2013-08-21/2013-08-22/2013-08-23/2013-08-24/2013-08-25/2013-08-26/2013-08-27/2013-08-28/2013-08-29/2013-08-30/2013-08-31/2013-12-01/2013-12-02/2013-12-03/2013-12-04/2013-12-05/2013-12-06/2013-12-07/2013-12-08/2013-12-09/2013-12-10/2013-12-11/2013-12-12/2013-12-13/2013-12-14/2013-12-15/2013-12-16/2013-12-17/2013-12-18/2013-12-19/2013-12-20/2013-12-21/2013-12-22/2013-12-23/2013-12-24/2013-12-25/2013-12-26/2013-12-27/2013-12-28/2013-12-29/2013-12-30/2013-12-31/2014-01-01/2014-01-02/2014-01-03/2014-01-04/2014-01-05/2014-01-06/2014-01-07/2014-01-08/2014-01-09/2014-01-10/2014-01-11/2014-01-12/2014-01-13/2014-01-14/2014-01-15/2014-01-16/2014-01-17/2014-01-18/2014-01-19/2014-01-20/2014-01-21/2014-01-22/2014-01-23/2014-01-24/2014-01-25/2014-01-26/2014-01-27/2014-01-28/2014-01-29/2014-01-30/2014-01-31/2014-02-01/2014-02-02/2014-02-03/2014-02-04/2014-02-05/2014-02-06/2014-02-07/2014-02-08/2014-02-09/2014-02-10/2014-02-11/2014-02-12/2014-02-13/2014-02-14/2014-02-15/2014-02-16/2014-02-17/2014-02-18/2014-02-19/2014-02-20/2014-02-21/2014-02-22/2014-02-23/2014-02-24/2014-02-25/2014-02-26/2014-02-27/2014-02-28/2014-06-01/2014-06-02/2014-06-03/2014-06-04/2014-06-05/2014-06-06/2014-06-07/2014-06-08/2014-06-09/2014-06-10/2014-06-11/2014-06-12/2014-06-13/2014-06-14/2014-06-15/2014-06-16/2014-06-17/2014-06-18/2014-06-19/2014-06-20/2014-06-21/2014-06-22/2014-06-23/2014-06-24/2014-06-25/2014-06-26/2014-06-27/2014-06-28/2014-06-29/2014-06-30/2014-07-01/2014-07-02/2014-07-03/2014-07-04/2014-07-05/2014-07-06/2014-07-07/2014-07-08/2014-07-09/2014-07-10/2014-07-11/2014-07-12/2014-07-13/2014-07-14/2014-07-15/2014-07-16/2014-07-17/2014-07-18/2014-07-19/2014-07-20/2014-07-21/2014-07-22/2014-07-23/2014-07-24/2014-07-25/2014-07-26/2014-07-27/2014-07-28/2014-07-29/2014-07-30/2014-07-31/2014-08-01/2014-08-02/2014-08-03/2014-08-04/2014-08-05/2014-08-06/2014-08-07/2014-08-08/2014-08-09/2014-08-10/2014-08-11/2014-08-12/2014-08-13/2014-08-14/2014-08-15/2014-08-16/2014-08-17/2014-08-18/2014-08-19/2014-08-20/2014-08-21/2014-08-22/2014-08-23/2014-08-24/2014-08-25/2014-08-26/2014-08-27/2014-08-28/2014-08-29/2014-08-30/2014-08-31/2014-12-01/2014-12-02/2014-12-03/2014-12-04/2014-12-05/2014-12-06/2014-12-07/2014-12-08/2014-12-09/2014-12-10/2014-12-11/2014-12-12/2014-12-13/2014-12-14/2014-12-15/2014-12-16/2014-12-17/2014-12-18/2014-12-19/2014-12-20/2014-12-21/2014-12-22/2014-12-23/2014-12-24/2014-12-25/2014-12-26/2014-12-27/2014-12-28/2014-12-29/2014-12-30/2014-12-31/2015-01-01/2015-01-02/2015-01-03/2015-01-04/2015-01-05/2015-01-06/2015-01-07/2015-01-08/2015-01-09/2015-01-10/2015-01-11/2015-01-12/2015-01-13/2015-01-14/2015-01-15/2015-01-16/2015-01-17/2015-01-18/2015-01-19/2015-01-20/2015-01-21/2015-01-22/2015-01-23/2015-01-24/2015-01-25/2015-01-26/2015-01-27/2015-01-28/2015-01-29/2015-01-30/2015-01-31/2015-02-01/2015-02-02/2015-02-03/2015-02-04/2015-02-05/2015-02-06/2015-02-07/2015-02-08/2015-02-09/2015-02-10/2015-02-11/2015-02-12/2015-02-13/2015-02-14/2015-02-15/2015-02-16/2015-02-17/2015-02-18/2015-02-19/2015-02-20/2015-02-21/2015-02-22/2015-02-23/2015-02-24/2015-02-25/2015-02-26/2015-02-27/2015-02-28/2015-06-01/2015-06-02/2015-06-03/2015-06-04/2015-06-05/2015-06-06/2015-06-07/2015-06-08/2015-06-09/2015-06-10/2015-06-11/2015-06-12/2015-06-13/2015-06-14/2015-06-15/2015-06-16/2015-06-17/2015-06-18/2015-06-19/2015-06-20/2015-06-21/2015-06-22/2015-06-23/2015-06-24/2015-06-25/2015-06-26/2015-06-27/2015-06-28/2015-06-29/2015-06-30/2015-07-01/2015-07-02/2015-07-03/2015-07-04/2015-07-05/2015-07-06/2015-07-07/2015-07-08/2015-07-09/2015-07-10/2015-07-11/2015-07-12/2015-07-13/2015-07-14/2015-07-15/2015-07-16/2015-07-17/2015-07-18/2015-07-19/2015-07-20/2015-07-21/2015-07-22/2015-07-23/2015-07-24/2015-07-25/2015-07-26/2015-07-27/2015-07-28/2015-07-29/2015-07-30/2015-07-31/2015-08-01/2015-08-02/2015-08-03/2015-08-04/2015-08-05/2015-08-06/2015-08-07/2015-08-08/2015-08-09/2015-08-10/2015-08-11/2015-08-12/2015-08-13/2015-08-14/2015-08-15/2015-08-16/2015-08-17/2015-08-18/2015-08-19/2015-08-20/2015-08-21/2015-08-22/2015-08-23/2015-08-24/2015-08-25/2015-08-26/2015-08-27/2015-08-28/2015-08-29/2015-08-30/2015-08-31/2015-12-01/2015-12-02/2015-12-03/2015-12-04/2015-12-05/2015-12-06/2015-12-07/2015-12-08/2015-12-09/2015-12-10/2015-12-11/2015-12-12/2015-12-13/2015-12-14/2015-12-15/2015-12-16/2015-12-17/2015-12-18/2015-12-19/2015-12-20/2015-12-21/2015-12-22/2015-12-23/2015-12-24/2015-12-25/2015-12-26/2015-12-27/2015-12-28/2015-12-29/2015-12-30/2015-12-31",
    "expver": "1",
    "grid": "0.75/0.75",
    "levtype": "sfc",
    "param": "167.128",
    "step": "0",
    "stream": "oper",
    "time": "06:00:00",
    "type": "an",
    "format": 'netcdf',
    "target": str(output_file),
})


server = ECMWFDataServer()


years = range(1980, 2016)
for year in years:
    rng = pd.date_range(f'{year}-01-01', f'{year}-03-1', freq='D').append(
           pd.date_range(f'{year}-06-01', f'{year}-08-31', freq='D'))
    dates = '/'.join((t.strftime('%Y-%m-%d') for t in rng))
    server.retrieve({
    "class": "ei",
    "dataset": "interim",
    "date": dates,
    "expver": "1",
    "grid": "0.75/0.75",
    "levtype": "sfc",
    "param": "167.128",
    "step": "0",
    "stream": "oper",
    "time": "00:00:00",
    "type": "an",
    "format": 'netcdf',
    "target": f"era_interim_summer_tmp_{year}.nc",
})





# # Drought exposure
# 
# A simple accepted measure for drought is the Standardized Precipitation Index (SPI).
# 
# Agnew, C.T., Using the SPI to identify drought, Drought Network News, 12, 6–12, 2000
# 
# propose SPI thresholds:
# 
# | SPI      | Category         |
# |----------|------------------|
# | >= -0.84 | Normal           | 
# | < -0.84  | Moderate Drought |
# | < -1.28  | Severe drought   | 
# | < -1.65  | Extreme drought  |
# 
# 
# For starters, use the NCAR global SPI file for 1949-2012. This means cutting off a bit relative to the 2015 cutoff for the other indicators, but saves re-generating an SPI from ERA (this would be desirable in the future).
# 
# Select the locations experiencing 'Severe' drought on the 3-month basis. Define the drought indicator as 'number of months in drought' for a given year.
# 
# 

get_ipython().magic('matplotlib inline')

from pathlib import Path
from datetime import date

import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import matplotlib.pyplot as plt

import cartopy
from cartopy import crs

import geopandas as gpd 
from config import DATA_SRC,POP_DATA_SRC, ERA_MONTHLY_FILE, CLIMATOLOGY_FILE_RESAMP, SHAPEFILES_SRC
import weather_ecmwf
import util
import config

import climate_conversions
import population_tools


spi_file = DATA_SRC / 'weather' / 'spi3_6_12_1deg_cru_ts_3_21_1949_2012.nc'


spi = xr.open_dataset(str(spi_file))


spi


spi.spi3.mean(dim=['lat','lon']).plot()


droughts = spi.spi3.where(spi.spi3 < -1.28)


droughts = droughts.groupby('time.year').count(dim='time')
droughts = droughts.astype(np.float64)
droughts.name = 'n_severe_drought'


droughts.sum(dim=['lat', 'lon']).plot()


droughts.sel(year=2003).plot()


def get_drought_projection(droughts):
    with population_tools.PopulationProjector() as pop:
        years = list(range(2000,2013))
        def _gen():
            for year in years:
                print(year)
                yield pop.project(year, droughts.sel(year=year))
        droughts_pop = xr.concat(_gen(), dim='time')
        pop_sum = pop.data.population.sum(dim=['latitude', 'longitude'])
        return droughts_pop.compute(), pop_sum.compute()
    
droughts_pop, pop_sum = get_drought_projection(droughts)


droughts_pop_ts = (droughts_pop / pop_sum).sum(dim=['latitude', 'longitude'])


droughts_pop_ts.plot()





# # Extend the Temperature analysis using suitable datasets to get a trend over a long period (e.g. back to 1950)
# 
# 
# General plan
# 
# - repeat using NASA GISS and Peter's population data
# - adapt ERA approach to longer term by using same recent past base 1986-2008 but longer term population
# 

get_ipython().magic('matplotlib inline')
import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import rasterio
from rasterio.io import MemoryFile
from rasterio.warp import reproject, Resampling
from affine import Affine

import population_tools
from config import DATA_SRC, POP_DATA_SRC


# NOTE: giss is already calculated as a temperature difference

nasa_giss_anom = DATA_SRC / 'weather' / 'nasa_giss' / 'air.2x2.1200.mon.anom.comb.nc'
nasa_giss = xr.open_dataset(str(nasa_giss_anom))


nasa_giss_cos_lat = xr.ufuncs.cos(xr.ufuncs.radians(nasa_giss.lat))
# summer_anom_ts = (summer_anom.sel(year=slice('2000','2016')) * cos_lat).mean(dim=['latitude', 'longitude'])



# clim_t = era_climatology.temperature_2m

# def sub_months(era_t_yr):
#     """Swap in the time axis so the datasets auto-align
#     """
#     clim_t['time'] = era_t_yr.time
#     return era_t_yr - clim_t
    
# delta_t = era_weather.temperature_2m.groupby('time.year').apply(sub_months)



def collect_summer_delta(delta_t):
    """Wrap in a function to clear temporary vars from memory"""
    # northern hemisphere
    lat_north = delta_t.lat[delta_t.lat >= 0]
    lat_south = delta_t.lat[delta_t.lat < 0]

    # Summer North
    summer_jja = delta_t['time.season'] == 'JJA'

    # Summer South
    summer_djf = delta_t['time.season'] == 'DJF'

    nh = delta_t.sel(time=summer_jja).groupby('time.year').mean(dim='time')
    sh = delta_t.sel(time=summer_djf).groupby('time.year').mean(dim='time')

    summer_anom = xr.concat([nh.sel(lat=lat_north),  
                             sh.sel(lat=lat_south)], dim='lat')
    return summer_anom

summer_anom = collect_summer_delta(nasa_giss.air)


summer_anom_ts = (summer_anom * nasa_giss_cos_lat).mean(dim=['lat', 'lon'])
summer_anom_ts.plot()


# ### Now project to population
# 




# ### Copied from Peter
# 





# Regrid temperature onto population grid
ntime=len(years_giss)
temp_pop_f=np.zeros(ntime)
temp_pop_i=np.zeros(ntime)
temp_area=np.zeros(ntime)
weight_area=np.cos(lats*np.pi/180.0)
# Calculate mean temperature exposure for human population
for itime in range(0, ntime):
    dTgiss=tmp[itime,:,:]
    dT = basemap.interp(dTgiss,lons_giss,lats_giss,                      lons,lats,checkbounds=False,masked=False,order=1)
    weight_pop_i=wt_pop[0,:,:]   
    weight_pop_f=wt_pop[npops-1,:,:]  
    temp_pop_i[itime]=sum(dT*weight_pop_i)/sum(weight_pop_i)   
    temp_pop_f[itime]=sum(dT*weight_pop_f)/sum(weight_pop_f)  
    temp_area[itime]=sum(dT*weight_area)/sum(weight_area)    








# # Select results for specific countries
# 
# 
# ## Method
# 
# Get a countries shapefile and use raserio to build masks for chosen areas.
# 

get_ipython().magic('matplotlib inline')

from pathlib import Path
from datetime import date

import rasterio
import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import matplotlib.pyplot as plt
import cartopy.feature
import cartopy.crs as ccrs

from scipy import stats
from tqdm import tnrange, tqdm_notebook


import weather_ecmwf
import population_tools

from config import (DATA_SRC, ERA_MONTHLY_FILE, 
                    CLIMATOLOGY_FILE_MONTHLY, POP_DATA_SRC)


# TODO read the NE shapefile


# # Project NASA T anomaly onto population
# 
# - Use the NASA GISS temperature anomaly to get the exposure over a long period.
# - Problem is we don't have population pre 2000. Might be reasonable to back-interpolate at least to 1990, growth can be approximated to linear over that kind of time scale it seems.
# - 
# 

get_ipython().magic('matplotlib inline')
import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import rasterio
import matplotlib.pyplot as plt
from rasterio.io import MemoryFile
from rasterio.warp import reproject, Resampling
from affine import Affine
from tqdm import tnrange, tqdm_notebook


import population_tools
from config import DATA_SRC, POP_DATA_SRC


nasa_giss_anom = DATA_SRC / 'weather' / 'nasa_giss' / 'air.2x2.1200.mon.anom.comb.nc'


nasa_giss = xr.open_dataset(str(nasa_giss_anom))
nasa_giss = nasa_giss.rename({'lon':'longitude', 'lat':'latitude'})
nasa_giss


def collect_summer_delta(delta_t):
    """Wrap in a function to clear temporary vars from memory"""
    # northern hemisphere
    lat_north = delta_t.latitude[delta_t.latitude >= 0]
    lat_south = delta_t.latitude[delta_t.latitude < 0]

    # Summer North
    summer_jja = delta_t['time.season'] == 'JJA'

    # Summer South
    summer_djf = delta_t['time.season'] == 'DJF'

    nh = delta_t.sel(time=summer_jja).groupby('time.year').mean(dim='time')
    sh = delta_t.sel(time=summer_djf).groupby('time.year').mean(dim='time')

    summer_anom = xr.concat([nh.sel(latitude=lat_north),  
                             sh.sel(latitude=lat_south)], dim='latitude')
    return summer_anom

summer_anom = collect_summer_delta(nasa_giss)


nasa_giss.mean(dim=['latitude', 'longitude']).air.plot()


summer_anom.mean(dim=['latitude', 'longitude']).air.plot()


# temperature = nasa_giss.air.groupby('time.year').mean(dim='time')


target = xr.open_dataset(str(POP_DATA_SRC / 'histsoc_population_0.5deg_1861-2005.nc'),                         )


with population_tools.PopulationProjector('histsoc_population_0.5deg_1861-2005_.nc', mask_empty=False) as pop:
    da = xr.DataArray(pop.water_mask, coords=[pop.data.latitude, pop.data.longitude])
    da.plot()


with population_tools.PopulationProjector('histsoc_population_0.5deg_1861-2005.nc') as pop:
    pop_mean = pop.data.mean(dim=['latitude', 'longitude'])
    pop_sum = pop.data.sum(dim=['latitude', 'longitude'])


    def _gen():
        for year in tnrange(2000,2017):
            yield pop.project(year, summer_anom.sel(year=year))

    summer_exposures = xr.concat(_gen(), dim='year')   


yr_exposures[0].plot(robust=True)


yr_exposures = xr.concat(yr_exposures, dim='time')
yr_exposures.name = 'year_mean_exposure'


yr_exposures.to_netcdf(str(DATA_SRC / 'lancet' / 'nasa_giss_yr_exposure.nc'))





# # Change in labor capacity associated with wet bulb temperature
# 
# 
# - Calculate WBT, WBGT for current and climatology
# - Calculate labour capacity
# - Project to RURAL population
# 
# 
# The labour capacity in percent (%) at a given location as a function of Wet Bulb Globe Temperature (WBGT) is
# 
# $$
# labour\;capacity = 100 - 25* \max(0, WBGT - 25)^{2/3}
# $$
# 
# Note that this number MUST be > 0, and could equally be defined as
# 
# 
# $$
# labour\;capacity = \max(0, 100 - 25* \max(0, WBGT - 25)^{2/3})
# $$
# 
# 
# The global capacity is then defined as:
# 
# $$
# global\;capacity(t) =  \frac{ \int labour\;capacity(x,t) * P(x,t)dx }{\int P(x,t) }
# $$
# 
# Where P is restricted to the rural population. This gives a scalar value for each year. To quantify where and how much of the global labour capacity is being lost at each location x, the lost labour is defined locally as :
# 
# $$
# lost\;labour( x , t ) = \frac{( 100 − labour\;capacity( x , t ) ) ∗ P ( x , t )}{\bar P(t) }
# $$
# 

get_ipython().magic('matplotlib inline')

from pathlib import Path
from datetime import date

import numpy as np
import scipy as sp
import pandas as pd
import geopandas as gpd 
import xarray as xr
import matplotlib.pyplot as plt
import cartopy.crs as ccrs

from scipy import stats
from tqdm import tnrange, tqdm_notebook

from config import DATA_SRC,POP_DATA_SRC , ERA_MONTHLY_FILE, CLIMATOLOGY_FILE_RESAMP, SHAPEFILES_SRC
import weather_ecmwf
import util
import config

import climate_conversions
import population_tools

def calculate_labour_capacity(wbgt):
    """NOTE: wbgt in Kelvin so have to adjust original formula"""
    labourcapacity = np.maximum(100 - 25 * np.power(np.maximum(wbgt - 273.15 - 25 , 0), (2/3)), 0)
    return labourcapacity


# ## Plot the labour capacity function
# 

_wbgt = np.arange(10, 40, 1)
labourcapacity = np.maximum(0, 100 - 25 * np.power(np.maximum(_wbgt - 25 , 0), (2/3)))
plt.plot(_wbgt, labourcapacity)
plt.xlabel('WBGT (K)')
plt.ylabel('%')


# ## Load urban/rural population ratio and associate with country shapes
# 

UN_DEMOGRAPHICS_TABLE = pd.read_csv(POP_DATA_SRC / 'UN' / 'urban_pop_percentage.csv', index_col='Country Code')
UN_DEMOGRAPHICS_TABLE = UN_DEMOGRAPHICS_TABLE.drop(['Index', 'Major area, region, country or area', 'Note'], axis=1)

country_shapefile = DATA_SRC / 'GIS' / 'world'/ 'ne_50m_admin_0_countries' / 'ne_50m_admin_0_countries.shp'

# COUNTRY_POLY_SHP
COUNTRIES = gpd.read_file(str(country_shapefile))
# Translate to match raster coordinates
COUNTRIES.geometry = COUNTRIES.translate(xoff=180)

# Remove missing UN A3 code fields, convert to int and set as index
COUNTRIES.loc[COUNTRIES.un_a3 == '-099', 'un_a3'] = np.nan
COUNTRIES.un_a3 = COUNTRIES.un_a3.astype(float)
COUNTRIES = COUNTRIES[np.isfinite(COUNTRIES.un_a3)]
COUNTRIES.un_a3 = COUNTRIES.un_a3.astype(int)
COUNTRIES = COUNTRIES.set_index('un_a3')


def get_country_demographics_for_year(year):
    base= 5
    closest_year = int(base * round(float(year)/base))

    rural = 100 - UN_DEMOGRAPHICS_TABLE[f'{closest_year}']
    rural /= 100
    countries = COUNTRIES.copy()
    countries['pct_rural'] = rural
    return countries


pct_rural_rasters = []
with population_tools.PopulationProjector() as pop:
    for year in tnrange(2000, 2017):
        countries = get_country_demographics_for_year(year)
        raster = pop.rasterize_data(countries, 'pct_rural')
        raster*= pop.water_mask.squeeze()
        raster /= 100
        raster.shape = (*raster.shape, 1)
        pct_rural_rasters.append(xr.DataArray(raster, 
                                        coords=[pop.data.latitude, pop.data.longitude, [year]], 
                                        dims=['latitude', 'longitude', 'year'], name='pct_rural'))
        
pct_rural_rasters = xr.concat(pct_rural_rasters, dim='year')


pct_rural_rasters.to_netcdf(str(DATA_SRC / 'lancet' / 'population_rural.nc'))


pct_rural_rasters = xr.open_dataarray(str(DATA_SRC / 'lancet' / 'population_rural.nc'))


pct_rural_rasters.mean(dim=['latitude', 'longitude']).plot()


# ### Load ERA weather and Calculate relative humidity, wbt, wbgt
# 

def get_wbgt():
    era_weather = weather_ecmwf.weather_dataset(ERA_MONTHLY_FILE)
#     era_weather = era_weather.sel(time=slice('2000','2016'))
    era_weather.load()
    era_weather['relative_humidity'] = climate_conversions.calculate_relative_humidity(era_weather.temperature_2m, 
                                                                                       era_weather.temperature_dewpoint)
    era_weather['wbt'] = climate_conversions.calculate_wbt(era_weather.temperature_2m, 
                                      era_weather.relative_humidity, 
                                      era_weather.surface_pressure)
    era_weather['wbgt'] = climate_conversions.calculate_wbgt(era_weather.temperature_2m, 
                                      era_weather.relative_humidity, 
                                      era_weather.surface_pressure)
    
    return era_weather['wbgt']


# ### Extract JJA/DJF summer months
# 

def get_summer_wbgt():
    weather = get_wbgt()
    # northern hemisphere
    lat_north = weather.latitude[weather.latitude >= 0]
    lat_south = weather.latitude[weather.latitude < 0]

    # Summer North
    summer_jja = weather.time[weather['time.season'] == 'JJA']


    # Summer South
    summer_djf = weather.time[weather['time.season'] == 'DJF']



    nh = weather.sel(time=summer_jja).groupby('time.year').mean(dim='time')
    sh = weather.sel(time=summer_djf).groupby('time.year').mean(dim='time')
    wgbt_summer = xr.concat([nh.sel(latitude=lat_north),  
                             sh.sel(latitude=lat_south)], dim='latitude')
    return wbgt_summer
    
wgbt_summer = get_summer_wbgt()


wgbt_summer.to_netcdf(str(DATA_SRC /'lancet' / 'summer_wbgt.nc'))


wgbt_summer = xr.open_dataarray(str(DATA_SRC / 'lancet' / 'summer_wbgt.nc'))


# ## Plot a global map of the change in summer mean WBGT relative to historical
# 

historical = wgbt_summer.sel(year= slice(1986, 2008)).mean(dim='year')
current = wgbt_summer.sel(year=slice(2000, 2016))

wbgt_change = current - historical.squeeze()


ax = plt.axes(projection=crs.PlateCarree())
historical.plot(ax=ax, transform=crs.PlateCarree())
ax.coastlines();


f = plt.figure()
ax = plt.axes(projection=crs.PlateCarree())
wbgt_change.sel(year=2015).plot(ax=ax, transform=crs.PlateCarree())
ax.coastlines()
f.set_size_inches(6.5,3)



wbgt_change.mean(dim=['latitude', 'longitude']).plot()
plt.ylabel('WBGT change (K)')
plt.savefig('wbgt_change.png', bbox_inches='tight')


# ## Calculate global labour capacity change relative 1986-2008 reference period
# 

labour_capacity = calculate_labour_capacity(wgbt_summer)
labour_capacity_historical = labour_capacity.sel(year=slice(1986, 2008)).mean(dim='year')
labour_delta = labour_capacity.sel(year=slice(2000, 2016)) - labour_capacity_historical


labour_delta.to_netcdf('labour_capacity_delta.nc')


labour_delta = xr.open_dataarray('labour_capacity_delta.nc')


# ### Get the area mean of the labour capacity
# 

cos_lat = xr.ufuncs.cos(xr.ufuncs.radians(labour_delta.latitude))
labour_capacity_ts = (labour_delta.sel(year=slice(2000,2016))).mean(dim=['latitude', 'longitude'])


labour_capacity_ts.plot()


labour_capacity_ts.name = 'labour_capacity'
labour_capacity_ts.to_netcdf(str(DATA_SRC /'lancet' / 'labour_capacity_ts.nc'))



year_data = labour_delta.sel(year=2016) - labour_delta.sel(year=2000)
year_data = year_data * population_tools.get_water_mask(year_data)
f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
year_data.plot.pcolormesh(ax=ax,
                          transform=ccrs.PlateCarree(),
                          cbar_kwargs=dict(label='Change in labour capacity (%)'),
                          cmap='RdBu'
                         )
ax.coastlines()
plt.tight_layout()
# plt.title('Change in Labour capacity loss 2000 to 2016')


f.savefig('labour_capacity_delta_change_2000-2016.png', dpi=300)
f.savefig('labour_capacity_delta_change_2000-2016.pdf')


# ## Project to the rural population
# 

def get_global_capacity(labour_capacity):

    with population_tools.PopulationProjector() as pop:
        rural_pop_sum = (pop.data * pct_rural_rasters).sum(dim=['latitude', 'longitude'])
            
        def _gen():
            for year in tnrange(2000,2017):
                yield pop.project(year, labour_capacity.sel(year=year)) * pct_rural_rasters.sel(year=year)
                
        global_capacity = xr.concat(_gen(), dim='year')

        global_capacity_ts = global_capacity.sum(dim=['latitude', 'longitude']) / rural_pop_sum
        global_capacity_ts.name = 'labour_capacity'
    return global_capacity_ts.compute()

global_capacity_ts = get_global_capacity(labour_delta)


global_capacity_ts.name = 'labour_capacity'
global_capacity_ts.to_netcdf(str(DATA_SRC/'lancet'/'labour_capacity.nc'))


global_capacity_ts = xr.open_dataarray(str(DATA_SRC/'lancet'/'labour_capacity.nc'))


global_capacity_ts.to_dataframe(name='labour_capacity_change').to_csv('global_labour_capacity_change.csv')


# labour_capacity_ts.plot(color='C1',label='Area weighted')
global_capacity_ts.plot(color='C0',label='Exposure weighted')
# mean_exposures_ts.plot(color='C9', label='Experienced, Year 2000 baseline')


# anom_reg = stats.linregress(labour_capacity_ts.year.values, labour_capacity_ts.values)
# anom_reg = (anom_reg.slope * labour_capacity_ts.year) + anom_reg.intercept

exposures_reg = stats.linregress(global_capacity_ts.year.values, global_capacity_ts.values)
exposures_reg = (exposures_reg.slope * global_capacity_ts.year) + exposures_reg.intercept

# anom_reg.plot.line('--', color='C1', label='Global trend')
exposures_reg.plot.line('-.', color='C0', label='Exposure trend')


plt.xlabel('Year')
plt.ylabel('Labour capacity change (%)')
plt.legend()
plt.savefig('labour_capacity_comp_2000-2016.png', dpi=300)
plt.savefig('labour_capacity_comp_2000-2016.pdf')





output = labour_capacity_ts.to_dataframe().join(global_capacity_ts.to_dataframe())
output.columns = ['Area weighted % change', 'Exposure weighted % change']

output.to_excel(str(DATA_SRC / 'lancet' / 'labour_capacity.xlsx'), sheet_name='labour_capacity_change')


# ## Calculate lost labour
# 
# This is for the map view
# 

def get_lost_capacity():
    years = list(range(2000,2016))

    with population_tools.PopulationProjector(population_tools.PopulationType.density.value) as pop:
        rural_pct_raster = pop.rasterize_data(countries, 'pct_rural')
        rural_pct_raster.shape = (*rural_pct_raster.shape, 1)
        rural_pop_mean = (pop.data.population * rural_pct_raster).mean(dim=['latitude', 'longitude'])
        rural_pop_sum = (pop.data.population * rural_pct_raster).sum(dim=['latitude', 'longitude'])


        def _gen():
            for year in years:
                print(year)
                yield pop.project(year, 100 - labour_capacity.sel(year=year))
        print('To DataArray')
        lost_capacity = xr.concat(_gen(), dim='time')

        lost_capacity = (lost_capacity * rural_pct_raster) / rural_pop_mean
        return lost_capacity.compute()

lost_capacity = get_lost_capacity()


lost_capacity.to_netcdf(str(DATA_SRC / 'lancet' / 'labour_capacity_loss_pop.nc'))


# ## Calculate lost labour in terms of equivalent number of people removed
# 

def get_global_capacity(labour_capacity):

    with population_tools.PopulationProjector() as pop:
        rural_pop_sum = (pop.data * pct_rural_rasters).sum(dim=['latitude', 'longitude'])
            
        def _gen():
            for year in tnrange(2000,2017):
                yield pop.project(year, labour_capacity.sel(year=year)) * pct_rural_rasters.sel(year=year)
                
        global_capacity = xr.concat(_gen(), dim='year')

        global_capacity_ts = global_capacity.sum(dim=['latitude', 'longitude']) / rural_pop_sum
        global_capacity_ts.name = 'labour_capacity'
    return global_capacity_ts.compute()



def get_lost_population(labour_anom):

    with population_tools.PopulationProjector() as pop:
        rural_pop_sum = (pop.data * pct_rural_rasters).sum(dim=['latitude', 'longitude'])
            
        def _gen():
            for year in tnrange(2000,2017):
                yield pop.project(year, labour_anom.sel(year=year)) * pct_rural_rasters.sel(year=year)
                
        global_capacity = xr.concat(_gen(), dim='year')

        global_capacity_ts = global_capacity.sum(dim=['latitude', 'longitude'])
        global_capacity_ts.name = 'labour_capacity'
    return global_capacity_ts.compute()


labour_delta_frac = (labour_delta / 100).copy()


lost_capacity_ts = get_lost_population(labour_delta_frac)


lost_capacity_ts.plot()
plt.ylabel('''Change in equivalent number of labourers''')

plt.savefig(str(COUNTRY_BRIEFS / 'labour_capacity' /'labourer_number_change.png'), bbox_inches='tight')


COUNTRY_BRIEFS = Path('./country_briefs')
lost_capacity_ts.to_dataframe().to_csv(COUNTRY_BRIEFS / 'labour_capacity' /'labourer_number_change.csv')





# # Reduce the resolution of the water mask to match the population
# 

get_ipython().magic('matplotlib inline')


import numpy as np
import pandas as pd
import rasterio
import xarray as xr
import matplotlib.pyplot as plt
from affine import Affine
from numba import jit
from rasterio import features
from rasterio.crs import CRS
from rasterio.enums import Resampling
from rasterio.warp import reproject

import population_tools
from config import POP_DATA_SRC



def derez_water_mask(file_path, n_iters=1):
    """
    Load water mask and invert such that land is true and water is false
    De rex the water mask by performing 'or' of alternate rows
    and columns such that any point where one square is water (false)
    and the other square is land (true) the resulting point is considered as
    land, since the population may be non-zero.
    
    This is a bit fancier than just performing a decimated read 
    (https://mapbox.github.io/rasterio/topics/resampling.html)
    with the aim of avoiding dropping bits of the population
    """
    with rasterio.open(str(file_path)) as pop:
        print(pop.meta)
        pop_meta = pop.meta
        trns = pop.transform
#         population = pop.read(1, masked=True)
        population = pop.read_masks(1)

        population = population.astype(bool)
    for i in range(n_iters):
        
        first = population[::2, :]
        second = population[1::2, :]
        if second.shape[0] < first.shape[0]:
            # missing a row, need to 'wrap'- just double the values from 'first' as an appoximation
            second = np.vstack((second, first[-1, :]))
        population = first | second
        # Sum every other column
        if second.shape[1] < first.shape[1]:
            # missing a row, need to 'wrap'- just double the values from 'first' as an appoximation
            second = np.hstack((second, first[:, -1]))
        first = population[:, ::2]
        second = population[:, 1::2]
        # population = population[:, ::2] + population[:, 1::2]
        population = first | second
        
        # Output affine scaled by 2
        trns = Affine(trns.a * 2, trns.b, trns.c, trns.d, trns.e * 2, trns.f)
        
    return population, trns, pop_meta
    # Reduction to 1/4 of the original size already makes life much easier


def save_population_geotiff(population, trns, pop_meta):
    print('Saving')
    print(population.shape)
    population = population.astype(float)


    with rasterio.open(str(POP_DATA_SRC / 'nasa_grid' / _POPULATION_PATH_TEMPLATE.format(resolution=REZ_FIX)),
                       'w',
                       driver='GTiff',
                       height=population.shape[0],
                       width=population.shape[1],
                       count=1,
                       dtype='float64',
                       crs=pop_meta['crs'],
                       transform=trns,
                       compress='lzw') as new_dataset:
        new_dataset.write(population, 1)


# REZ_FIX = 'eightres'
REZ_FIX = 'sixteenres'


_POPULATION_PATH_TEMPLATE = 'water_mask_{resolution}.tif'
input_file = POP_DATA_SRC / 'nasa_grid'/ 'gpw-v4-data-quality-indicators-water-mask' / 'gpw-v4-data-quality-indicators_water-mask.tif'
# input_file = (POP_DATA_SRC / 'nasa_grid'/ 'count'/
#               'gpw-v4-population-count-adjusted-to-2015-unwpp-country-totals-2000' / 
#               'gpw-v4-population-count-adjusted-to-2015-unwpp-country-totals_2000.tif')


population, trns, pop_meta = derez_water_mask(input_file, n_iters=4)


save_population_geotiff(population, trns, pop_meta)


file_path = POP_DATA_SRC / 'water_mask_sixteenres.tif'


with rasterio.open(str(file_path)) as pop:
    pop_mask = pop.read(1)
    plt.imshow(pop_mask)


target = xr.open_dataset(str(POP_DATA_SRC / 'histsoc_population_0.5deg_1861-2005.nc4'), 
                         decode_times=False
                        )
target = target.rename({'lon':'longitude', 'lat':'latitude'})
target


# file_path = POP_DATA_SRC / 'water_mask_eightres.tif'
file_path = POP_DATA_SRC / 'water_mask_sixteenres.tif'


with rasterio.open(str(file_path)) as pop:
    pop_mask = pop.read(1)
    aff = pop.transform
    newarr = np.empty(shape=(len(target.latitude),
                         len(target.longitude)))

    newaff = population_tools.get_affine(target)
    
    reproject(
        pop_mask, newarr,
        src_transform = aff,
        dst_transform = newaff,
        src_crs = pop.crs,
        dst_crs = pop.crs,
        resample = Resampling.bilinear)



plt.imshow(newarr)





# # Temperature change exposure using ERA weather and climatology, 2000-2015
# 
# - Project temperature changes between ERA interim and ERA climatology onto gridded population from NASA for 2000-2015
# - Calculate global average as sum of exposure divided by total population
# 
# ### Metric 1.1: Exposure to temperature change
# 
# The vulnerability to climate change is a function of the physical hazard (change in temperature, precipitation, humidity etc) and the number of (vulnerable) people exposed. A first order measure of exposure is defined here as:
# 
# 
# $$
# E(x,t) = \Delta T(x,t)P(x,t)
# $$
# 
# and the global average is
# 
# $$
# \bar{E} = \frac{\int \Delta T(x,t)P(x,t) dx}{\int P(x,t) dx}
# $$
# 
# Where $\Delta T(x,t)$ is the change in the summer mean temperature (Northern Hemisphere JJA, Southern Hemisphere DJF) at location x at time t from the recent historical summer mean (1986-2005). $P(x,t)$ is the population at location x at time t in millions.
# 
# The relative population density was also proposed to calculate the global mean values of exposure;
# 
# $$
#     E(x,t) = \frac{\Delta T(x,t)D(x,t)}{\bar D}
# $$
# 
# Where $D(x,t) = \tfrac{P(x,t)}{A(x)}$ is the population density at x at time t, and $\bar D$ is the global mean population density. This will result in the same qualitative conclusions as equation 1, but the units have been converted from Kelvin millions of people to Kelvin for the exposure maps.
# 
# **NOTE: The aim of this final indicator is to have an axis in Kelvin, and this is probably the most important one. The reason for this is that it makes it easy to have plots of the raw temperature change and the exposure change side by side and demonstrate with comparable axes that there is an important difference between the change in temperature and the change in temperature experienced by people**
# 
# 
# ### Updates/Clarifications to Method
# 
# Aim is to measure 'temperature change experienced by people'. End goal is a value in Kelvin which is the equivalent of the global mean temperature change but weighted by population
# 
# We operate on gridded data.
# 
# First, just multiply the temperature change by the number of people at each point (x) for a given time (t):
# 
# $$
# E(x,t) = \Delta T(x,t)P(x)
# $$
# 
# 
# We want to limit to the temperature change in the summer months for a given year, so first define all operations for a chosen year Y. The flobal $\Delta T(x,t)$ array is calculated by taking the mean temperature change for June, July, August for the northern hemisphere (latitude >= 0) and joining it with the array ofthe mean temperature change for December, January, February for the southern hemisphere (latitude < 0).
# 
# This gives a value in Kelvin x Npeople, which isn't hugely intuitive. When we take the global average with therefore divide by the total population for that year, $\sum P(x)$:
# 
# $$
# \bar{E} = \frac{\sum \Delta T(x,t)P(x,t)}{\sum P(x)}
# $$
# 
# This can be repeated for each year to get a time series. However, we'd also like to map the value for each year in a similarly intuitive way. We can do this using the mean population per grid point:
# 
# $$
# \bar{P} = \sum P(x) / N
# $$
# 
# And calculating the exposure at each point as the population divided by the mean population:
# 
# $$
# E(x,t) = \Delta T(x,t)P(x) / \bar{P}
# $$
# 
# The average of this value over the grid (with number of points N) is equal to the $\bar{E}$:
# 
# 
# $$
# Mean = \frac{\sum \Delta T(x,t)P(x,t) / \bar{P} }{N} \= \frac{\sum \Delta T(x,t)P(x,t) / (\sum P(x) / N) }{N} \= \frac{ \tfrac{N}{\sum P(x)} \sum \Delta T(x,t)P(x,t) }{N} \= \frac{ N   \sum \Delta T(x,t)P(x,t) }{N \sum P(x)} \= \frac{\sum \Delta T(x,t)P(x,t)}{\sum P(x)} = \bar{E} 
# $$
# 
# 
# #### Notes
# 
# Summer:
# 
# Northern Hemisphere JJA: June, July, August
# 
# Southern Hemisphere DJF: December, January, February
# 
# 

get_ipython().magic('matplotlib inline')

from pathlib import Path
from datetime import date

import rasterio
import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import matplotlib.pyplot as plt
import cartopy.crs as ccrs

from scipy import stats
from tqdm import tnrange, tqdm_notebook


import weather_ecmwf
import population_tools

from config import (DATA_SRC, ERA_MONTHLY_FILE, 
                    CLIMATOLOGY_FILE_MONTHLY, POP_DATA_SRC)


# # Load weather
# 

era_weather = weather_ecmwf.weather_dataset(ERA_MONTHLY_FILE)
era_weather = era_weather.sel(time=slice('2000','2016'))


era_climatology = weather_ecmwf.climatology_dataset(CLIMATOLOGY_FILE_MONTHLY)


era_climatology.temperature_2m.sel(time='1999-01-01').plot()


# ## Get ∆T for each month of each year
# 
# - Group by time.year and apply subtraction for each month
# 

clim_t = era_climatology.temperature_2m

def sub_months(era_t_yr):
    """Swap in the time axis so the datasets auto-align
    """
    clim_t['time'] = era_t_yr.time
    return era_t_yr - clim_t
    
delta_t = era_weather.temperature_2m.groupby('time.year').apply(sub_months)


# Climate change in 2000
f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
delta_t.sel(time='2000').mean(dim='time').plot.pcolormesh(
    ax=ax,
    transform=ccrs.PlateCarree(),
    cbar_kwargs=dict(label='K'),
    cmap='RdBu_r',
    vmin=-6, vmax=6
)
ax.coastlines()
ax.set_title('Temperature change in 2000 \n relative to 1986-2008 mean')
plt.tight_layout()


# Climate change in 2016
f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
delta_t.sel(time='2016').mean(dim='time').plot.pcolormesh(
    ax=ax,
    transform=ccrs.PlateCarree(),
    cbar_kwargs=dict(label='K'),
    cmap='RdBu_r',
    vmin=-6, vmax=6
)
ax.coastlines()
ax.set_title('Temperature change in 2016 \n relative to 1986-2008 mean')
plt.tight_layout()
# f.savefig('temperature_change_delta_2000-2016.png')


# ## Get the mean delta for each summer
# 

def collect_summer_delta(delta_t):
    """Wrap in a function to clear temporary vars from memory"""
    # northern hemisphere
    lat_north = delta_t.latitude[delta_t.latitude >= 0]
    lat_south = delta_t.latitude[delta_t.latitude < 0]

    # Summer North
    summer_jja = delta_t['time.season'] == 'JJA'

    # Summer South
    summer_djf = delta_t['time.season'] == 'DJF'

    nh = delta_t.sel(time=summer_jja).groupby('time.year').mean(dim='time')
    sh = delta_t.sel(time=summer_djf).groupby('time.year').mean(dim='time')

    summer_anom = xr.concat([nh.sel(latitude=lat_north),  
                             sh.sel(latitude=lat_south)], dim='latitude')
    return summer_anom

summer_anom = collect_summer_delta(delta_t)


# ### Weight the gridded mean anomaly by the latitude and calculate the global mean
# 
# - It's important to weight the grid before calculating the mean to account for the change in area of grid units from the equator to the poles
# 

cos_lat = xr.ufuncs.cos(xr.ufuncs.radians(summer_anom.latitude))
summer_anom_ts = (summer_anom.sel(year=slice('2000','2016')) * cos_lat).mean(dim=['latitude', 'longitude'])


summer_anom_ts.plot()
plt.xlabel('Year')
plt.ylabel('Mean warming (K)')

plt.savefig('mean_warming_2000-2016.png', dpi=300)


# ## Save the area weighted time series
# 

summer_anom.name = 'summer_global'
summer_anom.to_netcdf(str(DATA_SRC /'lancet' / 'summer_global.nc'))

summer_anom_ts.name = 'summer_global'
summer_anom_ts.to_netcdf(str(DATA_SRC /'lancet' / 'summer_global_ts.nc'))


summer_anom = xr.open_dataarray(str(DATA_SRC /'lancet' / 'summer_global.nc'))


summer_anom_ts = xr.open_dataarray(str(DATA_SRC /'lancet' / 'summer_global_ts.nc'))


# ## Project summer anomaly to total population
# 

def _project_to_population(summer_anom):
    """Wrap in function to control memory use"""
    
    with population_tools.PopulationProjector('population_count_2000-2020.nc') as pop:
        pop_mean = pop.data.mean(dim=['latitude', 'longitude'])
        pop_sum = pop.data.sum(dim=['latitude', 'longitude'])

        def _gen():
            for year in tnrange(2000,2017):
                yield pop.project(year, summer_anom.sel(year=year))
                
        print('Combining')
        summer_exposures = xr.concat(_gen(), dim='year')   
        summer_exposures_ts = (summer_exposures / pop_sum).sum(dim=['latitude', 'longitude']).compute()
        summer_exposures = (summer_exposures / pop_mean).compute()
#         summer_exposures_ts['time'] = summer_exposures_ts['time.year']
        
        return summer_exposures, summer_exposures_ts


summer_exposures, summer_exposures_ts = _project_to_population(summer_anom)


# Plot, rolling the axes
summer_exposures = xr.open_dataarray(str(DATA_SRC /'lancet' / 'summer_exposure.nc'))
newlon = (summer_exposures.longitude - 180).copy()
summer_exposures = summer_exposures.roll(longitude=-len(summer_exposures.longitude)//2)
summer_exposures['longitude'] = newlon
summer_exposures.plot(robust=True,  col='time', col_wrap=4)
plt.savefig('summer_exposures_grid.png')


# ## Save/load the exposure time series
# 

summer_exposures.name = 'summer_exposure'
summer_exposures.to_netcdf(str(DATA_SRC /'lancet' / 'summer_exposure.nc'))

summer_exposures_ts.name = 'summer_exposure'
summer_exposures_ts.to_netcdf(str(DATA_SRC /'lancet' / 'summer_exposure_ts.nc'))


summer_exposures = xr.open_dataarray(str(DATA_SRC /'lancet' / 'summer_exposure.nc'))
summer_exposures_ts = xr.open_dataarray(str(DATA_SRC /'lancet' / 'summer_exposure_ts.nc'))


summer_exposures_ts.plot()
plt.xlabel('Year')
plt.ylabel('Mean warming exposure (K)')
plt.savefig('mean_warming_experienced_2000-2015.png', dpi=300)
plt.savefig('mean_warming_experienced_2000-2015.pdf', dpi=300)


# ## Plot the time series
# 

summer_exposures_ts.plot(color='C0',label='Exposure weighted')
summer_anom_ts.plot(color='C1',label='Area weighted')
# mean_exposures_ts.plot(color='C9', label='Experienced, Year 2000 baseline')

summer_anom_reg = stats.linregress(summer_anom_ts.year.values, summer_anom_ts.values)
summer_anom_reg = (summer_anom_reg.slope * summer_anom_ts.year) + summer_anom_reg.intercept

summer_exposures_reg = stats.linregress(summer_exposures_ts.year.values, summer_exposures_ts.values)
summer_exposures_reg = (summer_exposures_reg.slope * summer_exposures_ts.year) + summer_exposures_reg.intercept

summer_exposures_reg.plot.line('-.', color='C0', label='Exposure trend')
summer_anom_reg.plot.line('--', color='C1', label='Global trend')

plt.xlabel('Year')
plt.ylabel('Mean warming (˚C)')
plt.legend()
plt.savefig('mean_warming_experienced_2000-2016.png', dpi=300)
plt.savefig('mean_warming_experienced_2000-2016.pdf')


output = summer_anom_ts.to_dataframe().join(summer_exposures_ts.to_dataframe())
output.columns = ['Area weighted change K ', 'Exposure weighted change K']

output.to_excel(str(DATA_SRC / 'lancet' / 'temperature_change.xlsx'), sheet_name='temperature_change')


# #### Plot change relative to year 2000
# 

# summer_exposures_ts_rel_2000 = summer_exposures_ts - summer_exposures_ts[0]
# summer_anom_ts_rel_2000 = summer_anom_ts - summer_anom_ts[0]

# summer_exposures_ts_rel_2000.plot(color='C0', label='Exposure weighted')
# summer_anom_ts_rel_2000.plot(color='C1',label='Area weighted')
# # (mean_exposures_ts - mean_exposures_ts[0]).plot(color='C9', label='Year 2000 baseline')

# summer_anom_reg = stats.linregress(summer_anom_ts_rel_2000.year.values, summer_anom_ts_rel_2000.values)
# summer_anom_reg = (summer_anom_reg.slope * summer_anom_ts_rel_2000.year) + summer_anom_reg.intercept

# summer_exposures_reg = stats.linregress(summer_exposures_ts_rel_2000.time.values, summer_exposures_ts_rel_2000.values)
# summer_exposures_reg = (summer_exposures_reg.slope * summer_exposures_ts_rel_2000.time) + summer_exposures_reg.intercept

# summer_exposures_reg.plot.line('-.',color='C0', label='Exposure trend')
# summer_anom_reg.plot.line('--',color='C1', label='Global trend')

# plt.xlabel('Year')
# plt.ylabel('Mean change from 2000 (K)')
# plt.legend()
# plt.savefig('mean_warming_experienced_2000-2015_rel2000.png', dpi=300)


# ## Map plots
# 
# - Plot the indicator at start, end, and difference between the two
# 

def map_for_year(year):
    year_anom = summer_anom.sel(year=year)

    f = plt.figure(figsize=(6,3))

    ax = plt.axes(projection=ccrs.PlateCarree())
    year_anom.plot.pcolormesh(ax=ax,
                              transform=ccrs.PlateCarree(),
                              cbar_kwargs=dict(label='K'))
    ax.coastlines()
    plt.tight_layout()
    f.savefig(f'temperature_change_{year}.png')


# Plot summer climate change in 2016
f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
summer_anom.sel(year=2000).plot.pcolormesh(
    ax=ax,
    transform=ccrs.PlateCarree(),
    cbar_kwargs=dict(label='K'),
    cmap='RdBu_r',
    vmin=-6, vmax=6)
ax.coastlines()
ax.set_title('Summer temperature difference in 2000 \n relative to 1986-2008 mean')
plt.tight_layout()
f.savefig('summer_temperature_change_2000.png')


# Plot summer climate change in 2016
f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
summer_anom.sel(year=2016).plot.pcolormesh(
    ax=ax,
    transform=ccrs.PlateCarree(),
    cbar_kwargs=dict(label='K'),
    cmap='RdBu_r',
    vmin=-6, vmax=6)
ax.coastlines()
ax.set_title('Summer temperature difference in 2016 \n relative to 1986-2008 mean')
plt.tight_layout()
f.savefig('summer_temperature_change_2016.png')


year_anom_delta = summer_anom.sel(year=2016) - summer_anom.sel(year=2000)

f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
year_anom_delta.plot.pcolormesh(ax=ax,
                          transform=ccrs.PlateCarree(),
                          cbar_kwargs=dict(label='K'))
ax.coastlines()
ax.set_title('Summer temperature change \n difference between 2000 and 2016')
plt.tight_layout()
f.savefig('temperature_change_delta_2000-2016.png')


year_anom = summer_anom.sel(year=2016)

f = plt.figure(figsize=(6,3))

ax = plt.axes(projection=ccrs.PlateCarree())
year_anom.plot.pcolormesh(ax=ax,
                          transform=ccrs.PlateCarree(),
                          cbar_kwargs=dict(label='K'))
ax.coastlines()
plt.tight_layout()
f.savefig('temperature_change_2016.png')





# # Plot of base population grids
# 
# Plot the population distribution in 2000 and the change in 2015 relative to 2000
# 

get_ipython().magic('matplotlib inline')

from pathlib import Path
from datetime import date

import rasterio
import numpy as np
import scipy as sp
import pandas as pd
import xarray as xr
import geopandas as gpd 
import matplotlib.pyplot as plt
import cartopy.crs as ccrs
from scipy import stats
from affine import Affine

import weather_ecmwf
import population_tools

from config import (DATA_SRC, ERA_MONTHLY_FILE, 
                    CLIMATOLOGY_FILE_MONTHLY, POP_DATA_SRC)



with population_tools.PopulationProjector('population_count_2000-2020.nc',
                                    'water_mask_sixteenres.tif',
#                                           'water_mask_eightres.tif',
                                          mask_empty=True) as pop:
    first_year = pop.data.sel(year=2000).load().squeeze()
    final_year = pop.data.sel(year=2016).load().squeeze() 


first_year.sum(dim=['latitude', 'longitude'],skipna=True)





f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())
first_year.plot.pcolormesh(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Year 2000 population')
plt.tight_layout()
plt.show()
f.savefig('year_2000_population.png', dpi=300, bbox_inches='tight')


f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())
final_year.plot(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Year 20016 population')
plt.tight_layout()
plt.show()
f.savefig('year_2016_population.png', dpi=300, bbox_inches='tight')


pop_delta = final_year - first_year
pop_delta.name = 'Change in population'


f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())
pop_delta.plot(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Population change 2000 to 2016')
plt.tight_layout()
plt.show()
f.savefig('2000-2016_population_change.png', dpi=300, bbox_inches='tight')


with population_tools.PopulationProjector('population_density_2000-2020.nc', mask_empty=True) as pop:
    first_year = pop.data.sel(year=2000).load().squeeze()
    final_year = pop.data.sel(year=2016).load().squeeze() 


f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())

first_year.name = 'People/km2'
first_year.plot.pcolormesh(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Year 2000 population density')
plt.tight_layout()
plt.show()
f.savefig('year_2000_population_density.png', dpi=300, bbox_inches='tight')


f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())
final_year.name = 'People/km2'


final_year.plot(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Year 2016 population density')
plt.tight_layout()
plt.show()
f.savefig('year_2016_population_density.png', dpi=300, bbox_inches='tight')


pop_delta = final_year - first_year
pop_delta.name = 'Change in density (people/km2)'
f = plt.figure()
f.set_size_inches(6.5,3)
ax = plt.axes(projection=ccrs.PlateCarree())
pop_delta.plot(robust=True, ax=ax,
                transform=ccrs.PlateCarree())
ax.coastlines()
ax.set_title('Population density change 2000 to 2016')
plt.tight_layout()
plt.show()
f.savefig('2000-2016_population_density_change.png', dpi=1000, bbox_inches='tight')





